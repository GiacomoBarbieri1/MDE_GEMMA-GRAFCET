(this["webpackJsonpgemma-grafcet"]=this["webpackJsonpgemma-grafcet"]||[]).push([[0],{392:function(e,t,n){},424:function(e,t,n){e.exports=n(732)},431:function(e,t,n){},662:function(e,t,n){},730:function(e,t,n){},732:function(e,t,n){"use strict";n.r(t);var i=n(151),r=n(132),a=n(0),o=n.n(a),s=n(30),c=n.n(s),l=n(19),u=n.n(l),p=n(27),d=n(36),h=n(20),f=n(733),y=n(794),b=n(787),m=n(786),v=n(789),g=n(788),O=n(34),E=n(9),x=n(11),j=n(15),k=n(16),w=n(22),N=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:14,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:14,r=t+n;return"M".concat(e," ").concat(t," L").concat(e-i/2," ").concat(r," L").concat(e+i/2," ").concat(r," Z")},C=Object(w.a)((function(e){var t=e.connection,n=ri();if(t.isHidden&&!n.showHidden)return o.a.createElement(o.a.Fragment,null);var i=t.from,r=t.to,a=t.isSelected,s=function(e){var t=e.data.connectionStartPosition;if(void 0!==t){var n=t();if(void 0!==n){var i=e.x,r=e.y;return r+="top"in n?n.top:e.height-n.bottom,"left"in n?i+=n.left:r+=e.width-n.right,{x:i,y:r}}}return{x:e.x+e.width/2,y:e.y+e.height/2}}(i),c=s.x,l=s.y,u=r.x+r.width/2,p=r.y+r.height/2,d=function(e,n){t.innerPoints.splice(n,0,function(e){var t=document.getElementsByClassName("canvas-wrapper")[0].getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}(e))},f=[];return o.a.createElement(o.a.Fragment,null,o.a.createElement(o.a.Fragment,null,t.innerPoints.map((function(e,i){f.push(o.a.createElement("circle",{cx:e.x,cy:e.y,r:"7",fill:"RoyalBlue",key:"".concat(t.from.key).concat(t.to.key).concat(i),onClick:function(e){t.graph.selectedConnection=t,void 0!==t.graph.selectedPointIndex?t.graph.selectedPointIndex=void 0:t.graph.selectedPointIndex=i}}));var r=o.a.createElement("path",{key:"".concat(t.from.key).concat(t.to.key).concat(i-1).concat(i),style:{strokeWidth:3,stroke:"black",opacity:t.isHidden?.07:1},d:"M".concat(c," ").concat(l," L").concat(e.x," ").concat(e.y),onClick:function(e){e.shiftKey?d(e,i):n.selectConnection(t)}});return c=e.x,l=e.y,r}))),o.a.createElement("path",{style:{strokeWidth:3,stroke:"black",opacity:t.isHidden?.07:1},d:"M".concat(c," ").concat(l," L").concat(u," ").concat(p),onClick:function(e){e.shiftKey?d(e,0):n.selectConnection(t)}}),f,!t.isHidden&&function(){var e,i,s=p-l,d=u-c;if(0===d)e=0,i=(p>l?1:-1)*r.height/2;else if(0===s)i=0,e=(u>c?1:-1)*r.width/2;else{var f=Math.abs(s/d),y=f>r.height/r.width?[r.height/2/f,r.height/2]:[r.width/2,r.width/2*f],b=Object(h.a)(y,2),m=b[0],v=b[1];i=(p>l?1:-1)*v,e=(u>c?1:-1)*m}var g=u-e,O=p-i,E=(c+u)/2,x=(l+p)/2,j=90+180*Math.atan2(p-l,u-c)/Math.PI;return o.a.createElement(o.a.Fragment,null,o.a.createElement(A,{connection:t,texts:t.data.connectionText,x:E,rectFill:a?"#eeedff":"#eee",y:x,onClick:function(e){return n.selectConnection(t)}}),o.a.createElement("path",{d:N(g,O),transform:"rotate(".concat(j," ").concat(g," ").concat(O,")")}))}())})),A=Object(w.a)((function(e){var t=e.texts,n=e.x,i=e.y,r=e.rectFill,a=void 0===r?"#eee":r,s=e.padding,c=void 0===s?3:s,l=e.onClick,u=e.connection,d=o.a.useState([]),f=Object(h.a)(d,2),y=f[0],b=f[1],m=t.reduce((function(e,t){return e+t.text}),""),v=o.a.useState(m),g=Object(h.a)(v,2),E=g[0],x=g[1],j=y.reduce((function(e,t){if(void 0===t)return e;var n=t.getBBox();return{width:e.width+n.width,height:Math.max(e.height,n.height)}}),{width:0,height:0});o.a.useEffect((function(){if(E!==m){var e=setTimeout((function(){return x(m)}),0);return function(){return clearTimeout(e)}}}));var k=0;return o.a.createElement(o.a.Fragment,null,o.a.createElement("rect",{width:j.width+2*c,height:j.height+2*c,x:n-j.width/2-c,y:i-j.height+c,fill:a,onClick:l,style:{cursor:"pointer"}}),t.map((function(e,t){var r,a,s=null===(r=y[t])||void 0===r?void 0:r.getBBox(),c=(void 0!==j?n-j.width/2:n)+k;return k+=void 0!==s?s.width:0,o.a.createElement("text",{key:"".concat(u.from.key).concat(u.to.key).concat(t),x:c,y:i+2,fill:"black",ref:function(e){if(null!==e&&void 0!==e&&!y[t]){var n=Object(O.a)(y);n[t]=e,b(n)}},onClick:l,style:Object(p.a)({cursor:"pointer"},null!==(a=e.style)&&void 0!==a?a:{})},e.text)})))})),I=(n(431),n(28)),S=n.n(I),R=n(89),D=n(38),T=n(17),L=n(12),P=(n(142),n(4)),F=n(779),M=n(798),_=n(790),z=n(45),H=n(90);function B(){var e=Object(R.a)(["\n  min-height: 38px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]);return B=function(){return e},e}var V=H.a.div(B()),G=function e(t){var n=this;if(Object(E.a)(this,e),this.choices=void 0,this.default=void 0,this.onChange=void 0,this.isObservableMap=function(){return"function"===typeof n.choices.keys&&"number"===typeof n.choices.size&&Symbol.toStringTag in n.choices},this.mobxProp=function(){return void 0!==n.default?z.a.optional(z.a.string,n.default):z.a.string},this.plotField=Object(w.a)((function(e){var t,i=e.name,r=e.model;return t=n.isObservableMap()?Array.from(n.choices.keys()):Object.keys(n.choices),o.a.createElement(U,{value:r[i],setValue:function(e){r[i]=e,void 0!==n.onChange&&n.onChange(e)},keys:t})})),this.choices=t.choices,this.default=t.default,this.onChange=t.onChange,this.isObservableMap()&&null===this.choices.get(this.default))throw Error("")},U=function(e){var t=e.keys,n=e.value,i=e.setValue,r=e.maxButton;return t.length>(null!==r&&void 0!==r?r:3)?o.a.createElement(_.a,{value:n,onChange:function(e){i(e.target.value)},autoWidth:!0,style:{minHeight:"35px",marginBottom:"3px"},disabled:t.length<=1},t.map((function(e){return o.a.createElement(M.a,{key:e,value:e},e)}))):o.a.createElement(V,null,o.a.createElement(F.a,{size:"small",color:"primary","aria-label":"outlined primary button group"},t.map((function(e){var t=e===n?{background:"#3f51b5",color:"white"}:{};return o.a.createElement(f.a,{key:e,onClick:function(){i(e)},style:t},e)}))))};var W={top:!1,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1};function J(e){return Object.entries(e).reduce((function(e,t){var n=Object(h.a)(t,2),i=n[0],r=n[1];return void 0!==r&&(e[i]=r),e}),Object(p.a)({},W))}function Y(e,t,n){var i=document.createElement("a"),r=new Blob([e],{type:n});i.href=URL.createObjectURL(r),i.download=t,i.click()}function K(e){var t=e.target.files;return new Promise((function(e,n){if(null!==t){var i=t[0];if("application/json"!==i.type)return window.alert("Debes seleccionar un archivo v\xe1lido, la extensi\xf3n debe ser '.json'."),e(void 0);var r=new FileReader;r.onload=function(t){var n;e(null===(n=t.target)||void 0===n?void 0:n.result)},r.onabort=function(t){e(void 0)},r.onerror=function(t){e(void 0)},r.readAsText(i)}else e(void 0)}))}var Q,$,q,X,Z,ee,te,ne=n(780),ie=n(792),re=function e(t){var n,i=this;if(Object(E.a)(this,e),this.default=void 0,this.maxLength=void 0,this.minLength=void 0,this.multiline=void 0,this.mobxProp=function(){return void 0!==i.default?z.a.optional(z.a.string,i.default):z.a.string},this.plotField=Object(w.a)((function(e){var t=e.name,n=e.model,r=o.a.useState(n[t]),a=Object(h.a)(r,2),s=a[0],c=a[1],l=n.errors,u=function(e){var r=e.target.value;c(r),void 0!==i.maxLength&&r.length>i.maxLength?l.set(t,"Max length exceded."):void 0!==i.minLength&&r.length<i.minLength?l.set(t,"Min length exceded."):(l.delete(t),n[t]=r)};return i.multiline?o.a.createElement("textarea",{key:t,className:"multiline-input",value:s,onChange:u}):o.a.createElement(ie.a,{key:t,value:s,fullWidth:!0,margin:"dense",inputProps:{style:{textAlign:"center"}},error:void 0!==l.get(t),style:{width:"140px"},onChange:u})})),this.default=t.default,this.maxLength=t.maxLength,this.minLength=t.minLength,this.multiline=null!==(n=t.multiline)&&void 0!==n&&n,"string"===typeof this.default){if(void 0!==this.minLength&&this.default.length<this.minLength)throw Error("");if(void 0!==this.maxLength&&this.default.length>this.maxLength)throw Error("")}},ae=function e(t){var n=this;Object(E.a)(this,e),this.default=void 0,this.required=void 0,this.mobxProp=function(){return void 0===n.default?z.a.boolean:z.a.optional(z.a.boolean,n.default)},this.plotField=Object(w.a)((function(e){var t=e.name,n=e.model;return o.a.createElement(ne.a,{checked:n[t],onChange:function(){n[t]=!n[t]},color:"primary"})})),this.default=t.default,this.required=void 0===t.required||t.required};!function(e){e.ENCLOSING="ENCLOSING",e.MACRO="MACRO",e.SIMPLE="SIMPLE",e.CONTAINER="CONTAINER"}(ee||(ee={})),function(e){e.F="F",e.D="D",e.A="A"}(te||(te={}));var oe=(Q=function(){function e(t,n){var i,r,a,s,c,l=this;Object(E.a)(this,e),this.node=t,Object(T.a)(this,"type",$,this),this.nInputs=Number.POSITIVE_INFINITY,this.errors=P.s.map(),Object(T.a)(this,"description",q,this),Object(T.a)(this,"isInitial",X,this),Object(T.a)(this,"family",Z,this),this.connectionStartPosition=function(){if(l.type===ee.CONTAINER)return{bottom:40,left:50}},this.spec={isInitial:new ae({default:!1,required:!0}),type:new G({default:ee.SIMPLE,choices:(c=Object.values(ee).filter((function(e){return e!==ee.CONTAINER})),c.reduce((function(e,t){return e[t.toString()]=t,e}),{}))})},this.View=Object(w.a)((function(e){var t,n=e.children,i=(t={},Object(D.a)(t,te.A,"#ecf5ff"),Object(D.a)(t,te.D,"#ffd6d6"),Object(D.a)(t,te.F,"#ebffec"),t);if(l.type===ee.CONTAINER)return o.a.createElement("div",{style:{position:"relative",border:"1px solid #eee",background:i[l.family],flex:1,width:400,height:400}},n);var r={},a={padding:"12px"},s=function(e){return e};l.isInitial&&(s=function(e){return o.a.createElement("div",{style:{padding:"5px"}},o.a.createElement("div",{style:{border:"1.5px solid"}},e))});var c=l.node.height-2-(l.isInitial?12:0);switch(l.type){case ee.ENCLOSING:return r={padding:"0 0",display:"flex"},s(o.a.createElement("div",{style:Object(p.a)(Object(p.a)({},r),{},{position:"relative"})},o.a.createElement(se,{left:!0,nodeHeight:c}),o.a.createElement("div",{style:Object(p.a)(Object(p.a)({},a),{},{padding:"12px 18px"})},l.node.name),o.a.createElement(se,{left:!1,nodeHeight:c})));case ee.MACRO:r={padding:"5px 0"},a={borderTop:"1.5px solid",borderBottom:"1.5px solid",borderRight:"0",borderLeft:"0",padding:"5px 12px"}}return s(o.a.createElement("div",{style:r},o.a.createElement("div",{style:a},l.node.name)))})),this.description=null!==(i=null===n||void 0===n?void 0:n.description)&&void 0!==i?i:"",this.family=null!==(r=null===n||void 0===n?void 0:n.family)&&void 0!==r?r:te.F,this.isInitial=null!==(a=null===n||void 0===n?void 0:n.isInitial)&&void 0!==a&&a,this.type=null!==(s=null===n||void 0===n?void 0:n.type)&&void 0!==s?s:ee.SIMPLE,Object(P.u)((function(e){return l.isInitial}),(function(e,t){if(e){var n=l.automationSystem.steps.find((function(e){return e.isInitial&&e!==l}));void 0!==n&&(n.isInitial=!1)}}))}return Object(x.a)(e,[{key:"isValidInput",value:function(e){return this.node.inputNodes.every((function(t){return t.data!==e.data}))}},{key:"name",get:function(){return this.node.name}},{key:"parent",get:function(){if(this.type!==ee.CONTAINER){switch(this.family){case te.A:return this.automationSystem.aFamily;case te.D:return this.automationSystem.dFamily;case te.F:return this.automationSystem.fFamily}throw new Error("")}}},{key:"automationSystem",get:function(){return this.node.graph.globalData}},{key:"_transitions",get:function(){return this.node.outputs.filter((function(e){return!e.isHidden})).map((function(e){return e.data})).sort((function(e,t){return e.priority-t.priority}))}},{key:"innerTransitionsLength",get:function(){return this._transitions.length}},{key:"transitions",get:function(){return this===this.automationSystem.fFamily.data?this._transitions:this.family===te.F?this.automationSystem.fFamily.data.transitions.concat(this._transitions):this._transitions}},{key:"id",get:function(){if(2===this.name.length){var e;switch(this.family){case te.A:e=0;break;case te.F:e=7;break;case te.D:e=13}return e+Number.parseInt(this.name[1])}return 0}},{key:"toJson",get:function(){return{family:this.family,description:this.description,type:this.type,isInitial:this.isInitial}}}]),e}(),$=Object(L.a)(Q.prototype,"type",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(L.a)(Q.prototype,"name",[P.i],Object.getOwnPropertyDescriptor(Q.prototype,"name"),Q.prototype),q=Object(L.a)(Q.prototype,"description",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=Object(L.a)(Q.prototype,"isInitial",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=Object(L.a)(Q.prototype,"family",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(L.a)(Q.prototype,"parent",[P.i],Object.getOwnPropertyDescriptor(Q.prototype,"parent"),Q.prototype),Object(L.a)(Q.prototype,"_transitions",[P.i],Object.getOwnPropertyDescriptor(Q.prototype,"_transitions"),Q.prototype),Object(L.a)(Q.prototype,"innerTransitionsLength",[P.i],Object.getOwnPropertyDescriptor(Q.prototype,"innerTransitionsLength"),Q.prototype),Object(L.a)(Q.prototype,"transitions",[P.i],Object.getOwnPropertyDescriptor(Q.prototype,"transitions"),Q.prototype),Object(L.a)(Q.prototype,"id",[P.i],Object.getOwnPropertyDescriptor(Q.prototype,"id"),Q.prototype),Object(L.a)(Q.prototype,"toJson",[P.i],Object.getOwnPropertyDescriptor(Q.prototype,"toJson"),Q.prototype),Q),se=function(e){var t=e.nodeHeight,n=e.left;return o.a.createElement("svg",{style:{width:"10px",height:t+"px",position:"absolute",right:n?void 0:0}},o.a.createElement("path",{d:n?"M 10 0 L 0 ".concat(t/2," L 10 ").concat(t):"M 0 0 L 10 ".concat(t/2," L 0 ").concat(t),stroke:"black",fill:"transparent"}))},ce=n(33);function le(){var e=Object(R.a)(["\n    width: 16px;\n    height: 16px;\n    z-index: 10;\n    background: rgba(0, 0, 0, 0.5);\n    border-radius: 8px;\n    cursor: pointer;\n    &:hover {\n      background: rgba(0, 0, 0, 1);\n    }\n  "]);return le=function(){return e},e}var ue=new(function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e,i){var r;return Object(E.a)(this,n),(r=t.call(this,e)).cb=void 0,r.cb=i,r}return Object(x.a)(n,[{key:"generateModel",value:function(e){return this.cb(e.initialConfig)}}]),n}(ce.AbstractModelFactory))("CUSTOM_NODE_TYPE",(function(e){return new pe(I.PortModelAlignment.LEFT)})),pe=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){return Object(E.a)(this,n),t.call(this,{type:"CUSTOM_NODE_TYPE",name:e,alignment:e})}return Object(x.a)(n,[{key:"createLinkModel",value:function(){return new I.DefaultLinkModel}}]),n}(I.PortModel),de=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(){return Object(E.a)(this,n),t.call(this,"CUSTOM_NODE_TYPE")}return Object(x.a)(n,[{key:"generateReactWidget",value:function(e){return o.a.createElement(fe,{engine:this.engine,node:e.model})}},{key:"generateModel",value:function(e){return new he(null)}}]),n}(ce.AbstractReactFactory),he=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,{type:"CUSTOM_NODE_TYPE"})).step=e,i.addPort(new pe(I.PortModelAlignment.TOP)),i.addPort(new pe(I.PortModelAlignment.LEFT)),i.addPort(new pe(I.PortModelAlignment.BOTTOM)),i.addPort(new pe(I.PortModelAlignment.RIGHT)),i}return n}(I.NodeModel),fe=Object(w.a)((function(e){var t=e.node,n=e.engine,i={},r={padding:"12px"},a=function(e){return e},s=t.step;s.isInitial&&(a=function(e){return o.a.createElement("div",{style:{padding:"5px",border:"1.5px solid"}},o.a.createElement("div",{style:{border:"1.5px solid"}},e))});var c=s.node.height-2-(s.isInitial?12:0);switch(s.type){case ee.ENCLOSING:return i={padding:"0 0",display:"flex"},a(o.a.createElement("div",{style:Object(p.a)(Object(p.a)({},i),{},{border:"1.5px solid",position:"relative"})},o.a.createElement(ye,{node:t,engine:n,size:s.node.height}),o.a.createElement(se,{left:!0,nodeHeight:c}),o.a.createElement("div",{style:Object(p.a)(Object(p.a)({},r),{},{padding:"12px 18px"})},s.node.name),o.a.createElement(se,{left:!1,nodeHeight:c})));case ee.MACRO:i={padding:"5px 0"},r={borderTop:"1.5px solid",borderBottom:"1.5px solid",borderRight:"0",borderLeft:"0",padding:"5px 12px"}}return a(o.a.createElement("div",{style:Object(p.a)(Object(p.a)({},i),{},{border:"1.5px solid",position:"relative"})},o.a.createElement(ye,{node:t,engine:n,size:s.node.height}),o.a.createElement("div",{style:r},s.node.name)))})),ye=function(e){var t=e.engine,n=e.node,i=e.size;return o.a.createElement(o.a.Fragment,null,o.a.createElement(I.PortWidget,{style:{top:i/2-8,left:-8,position:"absolute"},port:n.getPort(I.PortModelAlignment.LEFT),engine:t},o.a.createElement(be.Port,null)),o.a.createElement(I.PortWidget,{style:{left:i/2-8,top:-8,position:"absolute"},port:n.getPort(I.PortModelAlignment.TOP),engine:t},o.a.createElement(be.Port,null)),o.a.createElement(I.PortWidget,{style:{left:i-8,top:i/2-8,position:"absolute"},port:n.getPort(I.PortModelAlignment.RIGHT),engine:t},o.a.createElement(be.Port,null)),o.a.createElement(I.PortWidget,{style:{left:i/2-8,top:i-8,position:"absolute"},port:n.getPort(I.PortModelAlignment.BOTTOM),engine:t},o.a.createElement(be.Port,null)))},be=function e(){Object(E.a)(this,e)};be.Port=H.a.div(le());I.DefaultPortModel;var me,ve=Object(w.a)((function(){var e=ri(),t=Object(O.a)(e.nodes.values()),n=o.a.useMemo((function(){var e=S()({registerDefaultZoomCanvasAction:!1,registerDefaultDeleteItemsAction:!1});e.getLinkFactories().registerFactory(new I.RightAngleLinkFactory),e.getPortFactories().registerFactory(ue),e.getNodeFactories().registerFactory(new de);var n=new I.DiagramModel,i=new he(t[10].data);i.setPosition(340,350);var r=new I.DefaultNodeModel("Node B","rgb(255,255,0)"),a=r.addPort(new I.DefaultPortModel(!1,"out-1","Out"));r.setPosition(240,80);var o=new I.DefaultNodeModel("Node C","rgb(192,255,255)"),s=o.addPort(new I.DefaultPortModel(!0,"in-1","In"));o.setPosition(540,180);var c=new I.DefaultNodeModel("Node D","rgb(192,0,255)"),l=c.addPort(new I.DefaultPortModel(!0,"in-1","In"));c.setPosition(95,185);var u=e.getLinkFactories().getFactory(I.PathFindingLinkFactory.NAME),p=l.link(i.getPort(I.PortModelAlignment.LEFT),u);p.addLabel(new I.DefaultLabelModel({label:"dwdw"}));var d=a.link(s,u);return n.addAll(i,r,o,c,p,d),e.setModel(n),e}),[t]);return console.log(n),o.a.createElement("div",{style:{overflow:"auto",flex:"1",outline:"none",background:"white"},id:"canvas-scroll",tabIndex:0,onMouseMove:function(t){void 0!==e.selectedPointIndex&&document.getElementById("canvas-scroll").focus()},onKeyUp:function(t){"Escape"===t.key&&void 0!==e.selectedPointIndex&&void 0!==e.selectedConnection&&(e.selectedConnection.innerPoints.splice(e.selectedPointIndex,1),e.selectedPointIndex=void 0)}},o.a.createElement("div",{className:"canvas-wrapper",style:{background:"white"}},o.a.createElement(e.globalData.CanvasView,null),o.a.createElement("svg",{style:{width:"100%",height:"100%",position:"absolute"},id:"canvas-svg"},t.flatMap((function(e){return e.inputs})).map((function(e){return o.a.createElement(C,{connection:e,key:e.from.key+e.to.key})})))))})),ge=n(37),Oe=n(207),Ee=Object(w.a)((function(){for(var e=ri(),t=Object(a.useState)(!1),n=Object(h.a)(t,2),i=n[0],r=n[1],s=Object(O.a)(e.nodes.values()),c=s.reduce((function(e,t){return t.inputs.forEach((function(n){var i=e.get(n.to);void 0===i&&(i=[],e.set(n.to,i)),i.push(t)})),e}),new Map),l=[],u=new Map(s.filter((function(e){var t=0!==e.data.length;return t||l.push(e),t})).map((function(e){return[e,e.data.length]}))),p=0;0!==u.size&&l.length!==p;){var d,y=Object(ge.a)(l.slice(p));try{for(y.s();!(d=y.n()).done;){var b=d.value;p+=1;var m=c.get(b);if(void 0!==m){var v,g=Object(ge.a)(m);try{for(g.s();!(v=g.n()).done;){var E=v.value,x=u.get(E);1===x?(u.delete(E),l.push(E)):u.set(E,x-1)}}catch(j){g.e(j)}finally{g.f()}}}}catch(j){y.e(j)}finally{y.f()}}return u.size,o.a.createElement(Oe.a,{minWidth:200,defaultSize:{height:"auto",width:350},style:{position:"relative",background:"white",boxShadow:"0 1px 4px 1px #eee",border:"1px solid #eee"},enable:J({left:!0})},o.a.createElement("div",{className:"col",style:{height:"100%"}},o.a.createElement("div",{style:{borderBottom:"rgb(221 220 220) solid 1.5px"}},o.a.createElement(f.a,{onClick:function(t){Object.values(e.globalData.warnings).some((function(e){return e.length>0}))?r(!0):e.downloadSourceCode()}},"Download Code"),o.a.createElement(ci,{open:i,toggleDialog:function(){return r(!i)},warnings:e.globalData.warnings,accept:e.downloadSourceCode})),o.a.createElement("div",{style:{overflow:"auto",height:"100%",padding:"0 10px",flex:1}},o.a.createElement("pre",null,e.globalData.generateMainFile))))})),xe=n(405);function je(){return(je=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.a)("GemmaGrafcet",1,{upgrade:function(e){e.createObjectStore(me.graph,{keyPath:"key",autoIncrement:!1}),e.createObjectStore(me.node,{keyPath:"key",autoIncrement:!1}).createIndex("by-graph","graphKey"),e.createObjectStore(me.connection,{keyPath:"key",autoIncrement:!1}).createIndex("by-graph","graphKey")}});case 2:return t=e.sent,e.abrupt("return",new lt(t));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e){return"".concat(e.from,"_").concat(e.to)}function we(e,t){return Object.assign(t,{key:ke(t),graphKey:e})}!function(e){e.graph="graph",e.node="node",e.connection="connection"}(me||(me={}));var Ne,Ce,Ae,Ie,Se,Re,De,Te,Le,Pe,Fe,Me,_e,ze,He,Be,Ve,Ge,Ue,We,Je,Ye,Ke,Qe,$e,qe,Xe,Ze,et,tt,nt,it,rt,at,ot,st,ct,lt=function(){function e(t){Object(E.a)(this,e),this.db=t}return Object(x.a)(e,[{key:"fetchGraphs",value:function(){return this.db.getAll(me.graph)}},{key:"updateGraph",value:function(e){return this.db.put(me.graph,e)}},{key:"deleteGraph",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,i,r,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.db.transaction([me.graph,me.node,me.connection],"readwrite")).objectStore(me.graph).delete(t),i=Object(ge.a)([me.node,me.connection]),e.prev=3,i.s();case 5:if((r=i.n()).done){e.next=19;break}return a=r.value,e.next=9,n.objectStore(a).index("by-graph").openCursor(t);case 9:o=e.sent;case 10:if(!o){e.next=17;break}return o.delete(),e.next=14,o.continue();case 14:o=e.sent,e.next=10;break;case 17:e.next=5;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(3),i.e(e.t0);case 24:return e.prev=24,i.f(),e.finish(24);case 27:return e.next=29,n.done;case 29:case"end":return e.stop()}}),e,this,[[3,21,24,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"loadGraph",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,i,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.db.getAllFromIndex(me.node,"by-graph",t),this.db.getAllFromIndex(me.connection,"by-graph",t)]);case 2:return n=e.sent,i=Object(h.a)(n,2),r=i[0],a=i[1],e.abrupt("return",{nodes:r,connections:a});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addNodes",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){var i,r,a,o,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.db.transaction(me.node,"readwrite"),r={graphKey:t},a=Object(ge.a)(n);try{for(a.s();!(o=a.n()).done;)s=o.value,i.store.add(Object.assign(s,r))}catch(c){a.e(c)}finally{a.f()}return e.next=6,i.done;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteNode",value:function(e){return this.db.delete(me.node,e.key)}},{key:"updateNode",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.db.put(me.node,Object.assign(n,{graphKey:t})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateNodes",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){var i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={graphKey:t},e.abrupt("return",this.updateMany(me.node,n.map((function(e){return e.key})),n.map((function(e){return Object.assign(e,i)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addConnections",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){var i,r,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.db.transaction(me.connection,"readwrite"),r=Object(ge.a)(n);try{for(r.s();!(a=r.n()).done;)o=a.value,i.store.add(we(t,o))}catch(s){r.e(s)}finally{r.f()}return e.next=5,i.done;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteConnection",value:function(e){return this.db.delete(me.connection,ke(e))}},{key:"updateConnection",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.db.put(me.connection,we(t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateConnections",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.updateMany(me.connection,n.map(ke),n.map((function(e){return we(t,e)}))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"closeDB",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.db.close();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearDB",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.db.clear(me.graph),this.db.clear(me.connection),this.db.clear(me.node)]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateMany",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n,i){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.db.transaction(t,"readwrite"),e.next=3,Promise.all(i.map(function(){var e=Object(d.a)(u.a.mark((function e(t,i){var a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n[i],e.next=3,r.store.get(a);case 3:if(o=e.sent){e.next=6;break}throw new Error;case 6:return e.abrupt("return",r.store.put(Object(p.a)(Object(p.a)({},o),t)));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:return e.next=5,r.done;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}()},{key:"updateIncrementalSingle",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n,i){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.db.transaction(t,"readwrite"),e.next=3,r.store.get(n);case 3:if(a=e.sent){e.next=6;break}throw new Error;case 6:return r.store.put(Object(p.a)(Object(p.a)({},a),i)),e.next=9,r.done;case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}()}]),e}(),ut=n(795),pt=n(404),dt=(Ne=function(){function e(t,n,i,r,a){Object(E.a)(this,e),this.from=t,this.to=n,this.data=void 0,Object(T.a)(this,"isHidden",Ce,this),Object(T.a)(this,"innerPoints",Ae,this),this.data=i(this,r),this.isHidden=null!==a&&void 0!==a&&a}return Object(x.a)(e,[{key:"graph",get:function(){return this.from.graph}},{key:"isSelected",get:function(){return this.from.graph.selectedConnection===this}},{key:"toJson",get:function(){return{from:this.from.key,to:this.to.key,data:this.data.toJson,isHidden:this.isHidden}}}]),e}(),Ce=Object(L.a)(Ne.prototype,"isHidden",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(L.a)(Ne.prototype,"isSelected",[P.i],Object.getOwnPropertyDescriptor(Ne.prototype,"isSelected"),Ne.prototype),Object(L.a)(Ne.prototype,"toJson",[P.i],Object.getOwnPropertyDescriptor(Ne.prototype,"toJson"),Ne.prototype),Ae=Object(L.a)(Ne.prototype,"innerPoints",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.s.array([])}}),Ne),ht=(Ie=function(){function e(t,n){var i,r=this;Object(E.a)(this,e),this.graph=t,this.resizeObserver=void 0,this.element=void 0,Object(T.a)(this,"key",Se,this),Object(T.a)(this,"name",Re,this),Object(T.a)(this,"x",De,this),Object(T.a)(this,"y",Te,this),Object(T.a)(this,"width",Le,this),Object(T.a)(this,"height",Pe,this),Object(T.a)(this,"data",Fe,this),Object(T.a)(this,"isHidden",Me,this),Object(T.a)(this,"inputs",_e,this),Object(T.a)(this,"outputs",ze,this),Object(T.a)(this,"move",He,this),Object(T.a)(this,"setSize",Be,this),Object(T.a)(this,"setName",Ve,this),this.setElement=function(e){r.setSize(e.getBoundingClientRect()),r.element!==e&&(void 0!==r.resizeObserver&&r.resizeObserver.disconnect(),r.element=e,r.resizeObserver=new pt.a((function(t,n){r.setSize(e.getBoundingClientRect())})),r.resizeObserver.observe(e))},this.key=n.key,this.name=n.name,this.x=n.x,this.y=n.y,this.isHidden=null!==(i=n.isHidden)&&void 0!==i&&i,this.data=n.dataBuilder(this,n.data)}return Object(x.a)(e,[{key:"addInput",value:function(e){this.inputs.push(e),e.from.outputs.push(e)}},{key:"addOutput",value:function(e){this.outputs.push(e),e.to.inputs.push(e)}},{key:"inputNodes",get:function(){return this.inputs.map((function(e){return e.from}))}},{key:"outputNodes",get:function(){return this.outputs.map((function(e){return e.to}))}},{key:"toJson",get:function(){return{key:this.key,name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,isHidden:this.isHidden,data:this.data.toJson}}}]),e}(),Se=Object(L.a)(Ie.prototype,"key",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re=Object(L.a)(Ie.prototype,"name",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De=Object(L.a)(Ie.prototype,"x",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Te=Object(L.a)(Ie.prototype,"y",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le=Object(L.a)(Ie.prototype,"width",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),Pe=Object(L.a)(Ie.prototype,"height",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),Fe=Object(L.a)(Ie.prototype,"data",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me=Object(L.a)(Ie.prototype,"isHidden",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=Object(L.a)(Ie.prototype,"inputs",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.s.array()}}),Object(L.a)(Ie.prototype,"inputNodes",[P.i],Object.getOwnPropertyDescriptor(Ie.prototype,"inputNodes"),Ie.prototype),ze=Object(L.a)(Ie.prototype,"outputs",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P.s.array()}}),Object(L.a)(Ie.prototype,"outputNodes",[P.i],Object.getOwnPropertyDescriptor(Ie.prototype,"outputNodes"),Ie.prototype),Object(L.a)(Ie.prototype,"addInput",[P.h],Object.getOwnPropertyDescriptor(Ie.prototype,"addInput"),Ie.prototype),Object(L.a)(Ie.prototype,"addOutput",[P.h],Object.getOwnPropertyDescriptor(Ie.prototype,"addOutput"),Ie.prototype),He=Object(L.a)(Ie.prototype,"move",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){e.x+=t,e.y+=n}}}),Be=Object(L.a)(Ie.prototype,"setSize",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.width=t.width,e.height=t.height}}}),Ve=Object(L.a)(Ie.prototype,"setName",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.name=t}}}),Object(L.a)(Ie.prototype,"toJson",[P.i],Object.getOwnPropertyDescriptor(Ie.prototype,"toJson"),Ie.prototype),Ie),ft=n(400),yt=n.n(ft),bt=(Ge=function(){function e(t){var n,i,r,a,o,s,c=this;Object(E.a)(this,e),this.key=void 0,this.builders=void 0,this.hideOnDelete=void 0,this.globalData=void 0,this.db=void 0,Object(T.a)(this,"resetStore",Ue,this),Object(T.a)(this,"nodes",We,this),Object(T.a)(this,"selectedNode",Je,this),Object(T.a)(this,"selectedConnection",Ye,this),Object(T.a)(this,"selectedPointIndex",Ke,this),Object(T.a)(this,"mouseMoveEvent",Qe,this),Object(T.a)(this,"selectingInputFor",$e,this),Object(T.a)(this,"showHidden",qe,this),Object(T.a)(this,"selectNode",Xe,this),Object(T.a)(this,"selectConnection",Ze,this),Object(T.a)(this,"addNode",et,this),Object(T.a)(this,"removeNode",tt,this),Object(T.a)(this,"activateNode",nt,this),Object(T.a)(this,"removeConnection",it,this),Object(T.a)(this,"activateConnection",rt,this),Object(T.a)(this,"selectingInput",at,this),Object(T.a)(this,"assignInput",ot,this),Object(T.a)(this,"_selectingInputKeyListener",st,this),Object(T.a)(this,"addConnection",ct,this),this.saveModel=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(O.a)(c.nodes.entries()),e.next=3,c.db.clearDB();case 3:return e.next=5,Promise.all([c.db.updateGraph(c.toJson),c.db.addNodes(c.key,t.map((function(e){var t=Object(h.a)(e,2);t[0];return t[1].toJson}))),c.db.addConnections(c.key,t.flatMap((function(e){var t=Object(h.a)(e,2);t[0];return t[1].outputs})).map((function(e){return e.toJson})))]);case 5:case"end":return e.stop()}}),e)}))),this.downloadModel=function(){var e=Object(O.a)(c.nodes.entries()),t={graph:c.toJson,nodes:e.map((function(e){var t=Object(h.a)(e,2);t[0];return t[1].toJson})),connections:e.flatMap((function(e){var t=Object(h.a)(e,2);t[0];return t[1].outputs})).map((function(e){return e.toJson}))};return Y(JSON.stringify(t),"gemma-model.json","application/json"),t},this.downloadSourceCode=Object(d.a)(u.a.mark((function e(){var t,n,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=function e(t,n){var i,r=t.folder(n.name),a=Object(ge.a)(n.items);try{for(a.s();!(i=a.n()).done;){i.value.when({file:function(e){return r.file(e.name,e.content)},dir:function(t){return e(r,t)}})}}catch(o){a.e(o)}finally{a.f()}},n=new yt.a,i=c.globalData.generateSourceCode,t(n,i),e.next=6,n.generateAsync({type:"blob"});case 6:Y(e.sent,"gemma-grafcet-source-code.zip","application/zip");case 8:case"end":return e.stop()}}),e)}))),this.db=t.db,this.builders=t.builders,this.hideOnDelete=null!==(n=t.hideOnDelete)&&void 0!==n&&n,this.globalData=t.builders.graphBuilder(this,null===(i=t.json)||void 0===i?void 0:i.graph.data),this.key=null!==(r=null===(a=t.json)||void 0===a?void 0:a.graph.key)&&void 0!==r?r:Object(ut.a)();var l=null===(o=t.json)||void 0===o?void 0:o.nodes.reduce((function(e,n){var i=new ht(c,Object(p.a)(Object(p.a)({},n),{},{dataBuilder:t.builders.nodeBuilder}));return e[n.key]=i,e}),{});if(this.nodes=P.s.map(null!==l&&void 0!==l?l:{}),null===(s=t.json)||void 0===s||s.connections.forEach((function(e){var t=c.nodes.get(e.from),n=c.nodes.get(e.to);void 0!==t&&void 0!==n&&c.addConnection(t,n,e.data,e.isHidden)})),0!==this.nodes.size)if(this.selectedNode=this.nodes.values().next().value,0!==this.selectedNode.outputs.length)this.selectedConnection=this.selectedNode.outputs[0];else if(0!==this.selectedNode.inputs.length)this.selectedConnection=this.selectedNode.inputs[0];else{var f,y=Object(ge.a)(this.nodes.values());try{for(y.s();!(f=y.n()).done;){var b=f.value;if(0!==b.outputs.length){this.selectedConnection=b.outputs[0];break}}}catch(m){y.e(m)}finally{y.f()}}void 0!==this.globalData.initState&&this.globalData.initState(),document.addEventListener("mousemove",(function(e){c.mouseMoveEvent=e})),Object(P.u)((function(e){return{selectedPointIndex:c.selectedPointIndex,mouseMoveEvent:c.mouseMoveEvent}}),(function(e){if(void 0!==e.mouseMoveEvent&&void 0!==e.selectedPointIndex&&void 0!==c.selectedConnection){var t=document.getElementsByClassName("canvas-wrapper")[0].getBoundingClientRect(),n=e.mouseMoveEvent.clientX-t.left,i=e.mouseMoveEvent.clientY-t.top;c.selectedConnection.innerPoints[e.selectedPointIndex]={x:n,y:i}}}))}return Object(x.a)(e,[{key:"toJson",get:function(){return{data:this.globalData.toJson,key:this.key}}}]),e}(),Ue=Object(L.a)(Ge.prototype,"resetStore",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),We=Object(L.a)(Ge.prototype,"nodes",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je=Object(L.a)(Ge.prototype,"selectedNode",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ye=Object(L.a)(Ge.prototype,"selectedConnection",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke=Object(L.a)(Ge.prototype,"selectedPointIndex",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qe=Object(L.a)(Ge.prototype,"mouseMoveEvent",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$e=Object(L.a)(Ge.prototype,"selectingInputFor",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qe=Object(L.a)(Ge.prototype,"showHidden",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Xe=Object(L.a)(Ge.prototype,"selectNode",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.selectedNode=t}}}),Ze=Object(L.a)(Ge.prototype,"selectConnection",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.selectedConnection=t}}}),et=Object(L.a)(Ge.prototype,"addNode",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){if(e.globalData.canAddNode(t)){var i,r,a=new ht(e,{dataBuilder:e.builders.nodeBuilder,key:Object(ut.a)(),name:t,x:null!==(i=null===n||void 0===n?void 0:n.x)&&void 0!==i?i:100,y:null!==(r=null===n||void 0===n?void 0:n.y)&&void 0!==r?r:100,data:{type:t}});return e.nodes.set(a.key,a),a}}}}),tt=Object(L.a)(Ge.prototype,"removeNode",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(e.hideOnDelete){t.isHidden=!0;var n,i=Object(ge.a)(t.inputs);try{for(i.s();!(n=i.n()).done;){n.value.isHidden=!0}}catch(d){i.e(d)}finally{i.f()}var r,a=Object(ge.a)(t.outputs);try{for(a.s();!(r=a.n()).done;){r.value.isHidden=!0}}catch(d){a.e(d)}finally{a.f()}}else if(t===e.selectedNode&&(e.selectedNode=void 0),e.nodes.delete(t.key)){var o,s=Object(ge.a)(t.inputs);try{for(s.s();!(o=s.n()).done;){var c=o.value;c.from.outputs.remove(c)}}catch(d){s.e(d)}finally{s.f()}var l,u=Object(ge.a)(t.outputs);try{for(u.s();!(l=u.n()).done;){var p=l.value;p.to.inputs.remove(p)}}catch(d){u.e(d)}finally{u.f()}}}}}),nt=Object(L.a)(Ge.prototype,"activateNode",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){e.isHidden=!1;var t,n=Object(ge.a)(e.inputs);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.from.isHidden||(i.isHidden=!1)}}catch(s){n.e(s)}finally{n.f()}var r,a=Object(ge.a)(e.outputs);try{for(a.s();!(r=a.n()).done;){var o=r.value;o.to.isHidden||(o.isHidden=!1)}}catch(s){a.e(s)}finally{a.f()}}}}),it=Object(L.a)(Ge.prototype,"removeConnection",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.hideOnDelete?t.isHidden=!0:(t===e.selectedConnection&&(e.selectedConnection=void 0),t.from.outputs.remove(t),t.to.inputs.remove(t))}}}),rt=Object(L.a)(Ge.prototype,"activateConnection",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){e.from.isHidden||e.to.isHidden||(e.isHidden=!1)}}}),at=Object(L.a)(Ge.prototype,"selectingInput",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.selectingInputFor=t,window.addEventListener("keyup",e._selectingInputKeyListener)}}}),ot=Object(L.a)(Ge.prototype,"assignInput",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=new dt(e.selectingInputFor,t,e.builders.connectionBuilder);return n.from.addOutput(n),e.selectingInputFor=void 0,e.selectedConnection=n,window.removeEventListener("keyup",e._selectingInputKeyListener),n}}}),st=Object(L.a)(Ge.prototype,"_selectingInputKeyListener",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){"Escape"===t.key&&(e.selectingInputFor=void 0,window.removeEventListener("keyup",e._selectingInputKeyListener))}}}),ct=Object(L.a)(Ge.prototype,"addConnection",[P.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n,i,r){var a=new dt(t,n,e.builders.connectionBuilder,i,r);return a.from.addOutput(a),a}}}),Object(L.a)(Ge.prototype,"toJson",[P.i],Object.getOwnPropertyDescriptor(Ge.prototype,"toJson"),Ge.prototype),Ge);function mt(){var e=Object(R.a)(["\n  padding-bottom: 10px;\n  thead {\n    font-size: 1.1em;\n    font-weight: bolder;\n    tr td:last-child {\n      padding: 4px 0px 4px 10px;\n    }\n  }\n  tr td {\n    padding: 0;\n  }\n  tr td:first-child {\n    padding-right: 15px;\n    height: 32px;\n  }\n  tr td:last-child {\n    margin: auto auto;\n    padding-left: 10px;\n    text-align: center;\n    display: flex;\n    justify-content: center;\n    align-self: center;\n  }\n"]);return mt=function(){return e},e}var vt=Object(w.a)((function(e){var t=e.children;return o.a.createElement(Ot,null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("td",null,"Property"),o.a.createElement("td",null,"Value"))),o.a.createElement("tbody",null,t))})),gt=Object(w.a)((function(e){var t=e.self,n=ri();return o.a.createElement("div",{className:"col"},o.a.createElement(vt,null,Object.entries(t.data.spec).map((function(e){var n=Object(h.a)(e,2),i=n[0],r=n[1];return o.a.createElement("tr",{key:i},o.a.createElement("td",null,i),o.a.createElement("td",null,o.a.createElement(r.plotField,{name:i,model:t.data})))}))),o.a.createElement("div",{style:{margin:"0 3px"}},0!==t.data.nInputs&&o.a.createElement("div",{className:"row",key:"inputs",style:{alignItems:"center"}},o.a.createElement("h4",{style:{margin:"3px 0 5px 0",width:"90px"}},"Inputs:"),o.a.createElement("div",{style:{flex:1}},t.inputs.map((function(e){return o.a.createElement(f.a,{onClick:function(){return n.selectConnection(e)},key:e.from.key,variant:"outlined",size:"small",style:{minWidth:"39px"}},e.from.name)})),0===t.inputs.length&&"No inputs")),o.a.createElement("div",{className:"row",key:"outputs",style:{alignItems:"center"}},o.a.createElement("h4",{style:{margin:"3px 0 5px 0",width:"90px"}},"Outputs:"),o.a.createElement("div",{style:{flex:1}},t.outputs.map((function(e){return o.a.createElement(f.a,{onClick:function(){return n.selectConnection(e)},key:e.to.key,variant:"outlined",size:"small",style:{minWidth:"39px"}},e.to.name)})),0===t.outputs.length&&"No outputs"))))})),Ot=H.a.table(mt()),Et=n(734),xt=n(112),jt=(n(662),Object(w.a)((function(){var e,t=ri();if(null!=t.selectedNode){var n=t.selectedNode,i=t.selectedConnection;e=o.a.createElement("div",{style:{overflow:"auto",maxHeight:"100%",maxWidth:"100%",justifyContent:"space-around",backgroundColor:"#fafafa",display:"flex"},className:"row"},o.a.createElement("div",{className:"properties-view",key:"node-properties",id:"node-properties"},o.a.createElement("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"}},o.a.createElement("h3",{style:{margin:"5px 0px 10px 5px"}},"Step: ".concat(n.name)),o.a.createElement(Et.a,{onClick:function(e){n.isHidden?t.activateNode(n):t.removeNode(n)}},o.a.createElement(xt.a,{icon:n.isHidden?"eye":"eye-slash",color:"#000"}))),o.a.createElement(gt,{self:t.selectedNode})),o.a.createElement("div",{className:"properties-view",key:"connection-properties",id:"connection-properties"},void 0!==i&&o.a.createElement("div",{className:"col"},o.a.createElement("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"}},o.a.createElement("h3",{style:{margin:"5px 0 10px 5px"}},"Transition: ".concat(i.from.name," -> ").concat(i.to.name)),o.a.createElement(Et.a,{onClick:function(e){i.isHidden?t.activateConnection(i):t.removeConnection(i)}},o.a.createElement(xt.a,{icon:i.isHidden?"eye":"eye-slash",color:"#000"}))),o.a.createElement(i.data.ConnectionView,null))),o.a.createElement("div",{style:{minWidth:"270px"},className:"properties-view",key:"graph-properties"},o.a.createElement(t.globalData.View,null)))}else e=o.a.createElement("div",{style:{width:"150px"},className:"row"},o.a.createElement("div",{style:{width:"150px"},className:"center"},"Not selected"));return o.a.createElement(Oe.a,{minHeight:200,defaultSize:{height:295,width:"auto"},style:{position:"relative",background:"white",boxShadow:"0 1px 4px 1px #eee",border:"1px solid #eee"},enable:J({top:!0})},e)}))),kt=function(){function e(t){Object(E.a)(this,e),this.text=t}return Object(x.a)(e,[{key:"toString",value:function(){return this.text}}]),e}(),wt=function e(){Object(E.a)(this,e)};wt.textOrEmpty=function(e,t){return e?t:""};var Nt=function(e){return"_".concat(e.from.name,"_").concat(e.priority,"_MEM")},Ct=function(e){return e.expressionTokens.map((function(t){var n=Object(h.a)(t,2),i=n[0];n[1];return i instanceof kt?"GVL."+i.text+(e.savedSignalsWithMemory.has(i.text)?Nt(e):""):i})).join(" ")},At=function(e){return function(e,t){var n=t.isNested;return"".concat(e.map((function(e,t){return"\n".concat(0===t?"IF":"ELSIF"," ").concat(Ct(e)," THEN\n  State:=").concat(e.to.id,";  ").concat(n?"\n  Entry:=TRUE;":"")})).join("\n")).concat(0===e.length?"":"\nEND_IF")}(e.transitions,{isNested:!1})},It=function(e){var t=e.transitions;return"\n".concat(function(e){return"IF Entry THEN\n  ".concat(e.name,"(Initialization:=ENTRY);\n  Entry:=FALSE;\nEND_IF\n").concat(e.name,"(Initialization:=ENTRY);")}(e),"\n\n").concat(t.map((function(n,i){return"".concat(0===i?"IF":"ELSIF"," ").concat(Ct(n)).concat(function(n,i){var r=t.length-e.innerTransitionsLength<=i;switch(e.type){case ee.MACRO:return r&&!n.isNegated;case ee.ENCLOSING:return r&&n.isNegated}throw new Error("")}(n,i)?" AND ".concat(e.name,".Complete"):""," THEN\n  State:=").concat(n.to.id,";\n  Entry:=TRUE;\n  ").concat(e.transitions.flatMap((function(e){return e.signalsWithMemory.map((function(t){return"".concat(t).concat(Nt(e)," := FALSE;")}))})).join("  \n"))})).join("\n")).concat(wt.textOrEmpty(0!==t.length,"\nEND_IF"))},St=function(e){var t;return"\n// Variable declaration\nVAR\n".concat(e.steps.filter((function(e){return e.type===ee.ENCLOSING||e.type===ee.MACRO})).map((function(e){return"  ".concat(e.name,":").concat(e.name,"_FB;")})).join("\n"),"\n").concat(e.steps.filter((function(e){return e.type===ee.ENCLOSING||e.type===ee.MACRO})).flatMap((function(e){return e.transitions})).flatMap((function(e){return e.signalsWithMemory.map((function(t){return"".concat(t).concat(Nt(e))}))})).map((function(e){return"  ".concat(e,":BOOL:=FALSE;")})).join("\n"),"\n\n  State:UINT:=").concat(null===(t=e.initialStep)||void 0===t?void 0:t.id,";\n  Entry:BOOL:=TRUE;\nEND_VAR\n\n// Program behavior\nCASE State OF\n  ").concat(e.steps.map((function(e){return"\n  ".concat(e.id,": //State ").concat(e.name,"\n    ").concat(function(){switch(e.type){case ee.SIMPLE:return At(e);case ee.ENCLOSING:case ee.MACRO:return It(e);default:throw new Error("")}}().replace(/\n/g,"\n    "),"\n  ")})).join("\n"),"\nEND_CASE\n\n").concat(e.steps.filter((function(e){return e.type===ee.ENCLOSING||e.type===ee.MACRO})).flatMap((function(e){return e.transitions})).flatMap((function(e){return e.signalsWithMemory.map((function(t){return"IF State = ".concat(e.from.id," AND GVL.").concat(t," THEN\n  ").concat(t).concat(Nt(e)," := TRUE;\nEND_IF\n")}))})).join("\n"),"\n")},Rt=n(793),Dt=n(157),Tt=n(72),Lt=n(126),Pt=n(124),Ft=n(149),Mt=n(123),_t=n(43),zt=n(122),Ht=n(48),Bt=n(32),Vt=n(69),Gt=n(55),Ut=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e))._interp=new zt.ParserATNSimulator(n._ATN,Object(Lt.a)(i)),i}return Object(x.a)(n,[{key:"vocabulary",get:function(){return n.VOCABULARY}},{key:"grammarFileName",get:function(){return"SimpleBoolean.g4"}},{key:"ruleNames",get:function(){return n.ruleNames}},{key:"serializedATN",get:function(){return n._serializedATN}}]),Object(x.a)(n,[{key:"parse",value:function(){var e=new Wt(this._ctx,this.state);this.enterRule(e,0,n.RULE_parse);try{this.enterOuterAlt(e,1),this.state=12,this.expression(),this.state=13,this.match(n.EOF)}catch(t){if(!(t instanceof Ht.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}},{key:"expression",value:function(){var e=new Jt(this._ctx,this.state);this.enterRule(e,2,n.RULE_expression);try{switch(this.state=22,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,0,this._ctx)){case 1:e=new Yt(e),this.enterOuterAlt(e,1),this.state=15,this.match(n.NOT),this.state=16,this.expression();break;case 2:e=new Kt(e),this.enterOuterAlt(e,2),this.state=17,e._left=this.expressionAnd(),this.state=18,this.match(n.OR),this.state=19,e._right=this.expression();break;case 3:e=new Qt(e),this.enterOuterAlt(e,3),this.state=21,this.expressionAnd()}}catch(t){if(!(t instanceof Ht.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}},{key:"expressionAnd",value:function(){var e=new $t(this._ctx,this.state);this.enterRule(e,4,n.RULE_expressionAnd);try{switch(this.state=29,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,1,this._ctx)){case 1:e=new qt(e),this.enterOuterAlt(e,1),this.state=24,e._left=this.expressionSimple(),this.state=25,this.match(n.AND),this.state=26,e._right=this.expressionAnd();break;case 2:e=new Xt(e),this.enterOuterAlt(e,2),this.state=28,this.expressionSimple()}}catch(t){if(!(t instanceof Ht.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}},{key:"expressionSimple",value:function(){var e=new Zt(this._ctx,this.state);this.enterRule(e,6,n.RULE_expressionSimple);try{switch(this.state=40,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,2,this._ctx)){case 1:e=new en(e),this.enterOuterAlt(e,1),this.state=31,e._left=this.numExpression(),this.state=32,e._op=this.comparator(),this.state=33,e._right=this.numExpression();break;case 2:e=new tn(e),this.enterOuterAlt(e,2),this.state=35,this.match(n.IDENTIFIER);break;case 3:e=new nn(e),this.enterOuterAlt(e,3),this.state=36,this.match(n.LPAREN),this.state=37,this.expression(),this.state=38,this.match(n.RPAREN)}}catch(t){if(!(t instanceof Ht.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}},{key:"numExpression",value:function(){var e=new rn(this._ctx,this.state);this.enterRule(e,8,n.RULE_numExpression);try{switch(this.state=44,this._errHandler.sync(this),this._input.LA(1)){case n.IDENTIFIER:e=new an(e),this.enterOuterAlt(e,1),this.state=42,this.match(n.IDENTIFIER);break;case n.DECIMAL:e=new on(e),this.enterOuterAlt(e,2),this.state=43,this.match(n.DECIMAL);break;default:throw new Ft.NoViableAltException(this)}}catch(t){if(!(t instanceof Ht.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}},{key:"comparator",value:function(){var e,t=new sn(this._ctx,this.state);this.enterRule(t,10,n.RULE_comparator);try{this.enterOuterAlt(t,1),this.state=46,0!==(-32&(e=this._input.LA(1)))||0===(1<<e&(1<<n.GT|1<<n.GE|1<<n.LT|1<<n.LE|1<<n.EQ))?this._errHandler.recoverInline(this):(this._input.LA(1)===Bt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(i){if(!(i instanceof Ht.RecognitionException))throw i;t.exception=i,this._errHandler.reportError(this,i),this._errHandler.recover(this,i)}finally{this.exitRule()}return t}}],[{key:"_ATN",get:function(){return n.__ATN||(n.__ATN=(new Pt.ATNDeserializer).deserialize(Gt.toCharArray(n._serializedATN))),n.__ATN}}]),n}(Mt.Parser);Ut.AND=1,Ut.OR=2,Ut.NOT=3,Ut.TRUE=4,Ut.FALSE=5,Ut.GT=6,Ut.GE=7,Ut.LT=8,Ut.LE=9,Ut.EQ=10,Ut.LPAREN=11,Ut.RPAREN=12,Ut.DECIMAL=13,Ut.IDENTIFIER=14,Ut.WS=15,Ut.RULE_parse=0,Ut.RULE_expression=1,Ut.RULE_expressionAnd=2,Ut.RULE_expressionSimple=3,Ut.RULE_numExpression=4,Ut.RULE_comparator=5,Ut.ruleNames=["parse","expression","expressionAnd","expressionSimple","numExpression","comparator"],Ut._LITERAL_NAMES=[void 0,"'AND'","'OR'","'NOT'","'TRUE'","'FALSE'","'>'","'>='","'<'","'<='","'='","'('","')'"],Ut._SYMBOLIC_NAMES=[void 0,"AND","OR","NOT","TRUE","FALSE","GT","GE","LT","LE","EQ","LPAREN","RPAREN","DECIMAL","IDENTIFIER","WS"],Ut.VOCABULARY=new Vt.VocabularyImpl(Ut._LITERAL_NAMES,Ut._SYMBOLIC_NAMES,[]),Ut._serializedATN="\x03\uc91d\ucaba\u058d\uafba\u4f53\u0607\uea8b\uc241\x03\x113\x04\x02\t\x02\x04\x03\t\x03\x04\x04\t\x04\x04\x05\t\x05\x04\x06\t\x06\x04\x07\t\x07\x03\x02\x03\x02\x03\x02\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x05\x03\x19\n\x03\x03\x04\x03\x04\x03\x04\x03\x04\x03\x04\x05\x04 \n\x04\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x05\x05+\n\x05\x03\x06\x03\x06\x05\x06/\n\x06\x03\x07\x03\x07\x03\x07\x02\x02\x02\b\x02\x02\x04\x02\x06\x02\b\x02\n\x02\f\x02\x02\x03\x03\x02\b\f\x022\x02\x0e\x03\x02\x02\x02\x04\x18\x03\x02\x02\x02\x06\x1f\x03\x02\x02\x02\b*\x03\x02\x02\x02\n.\x03\x02\x02\x02\f0\x03\x02\x02\x02\x0e\x0f\x05\x04\x03\x02\x0f\x10\x07\x02\x02\x03\x10\x03\x03\x02\x02\x02\x11\x12\x07\x05\x02\x02\x12\x19\x05\x04\x03\x02\x13\x14\x05\x06\x04\x02\x14\x15\x07\x04\x02\x02\x15\x16\x05\x04\x03\x02\x16\x19\x03\x02\x02\x02\x17\x19\x05\x06\x04\x02\x18\x11\x03\x02\x02\x02\x18\x13\x03\x02\x02\x02\x18\x17\x03\x02\x02\x02\x19\x05\x03\x02\x02\x02\x1a\x1b\x05\b\x05\x02\x1b\x1c\x07\x03\x02\x02\x1c\x1d\x05\x06\x04\x02\x1d \x03\x02\x02\x02\x1e \x05\b\x05\x02\x1f\x1a\x03\x02\x02\x02\x1f\x1e\x03\x02\x02\x02 \x07\x03\x02\x02\x02!\"\x05\n\x06\x02\"#\x05\f\x07\x02#$\x05\n\x06\x02$+\x03\x02\x02\x02%+\x07\x10\x02\x02&'\x07\r\x02\x02'(\x05\x04\x03\x02()\x07\x0e\x02\x02)+\x03\x02\x02\x02*!\x03\x02\x02\x02*%\x03\x02\x02\x02*&\x03\x02\x02\x02+\t\x03\x02\x02\x02,/\x07\x10\x02\x02-/\x07\x0f\x02\x02.,\x03\x02\x02\x02.-\x03\x02\x02\x02/\v\x03\x02\x02\x0201\t\x02\x02\x021\r\x03\x02\x02\x02\x06\x18\x1f*.",Ut.__ATN=void 0;var Wt=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e,i){return Object(E.a)(this,n),t.call(this,e,i)}return Object(x.a)(n,[{key:"expression",value:function(){return this.getRuleContext(0,Jt)}},{key:"EOF",value:function(){return this.getToken(Ut.EOF,0)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterParse&&e.enterParse(this)}},{key:"exitRule",value:function(e){e.exitParse&&e.exitParse(this)}},{key:"accept",value:function(e){return e.visitParse?e.visitParse(this):e.visitChildren(this)}},{key:"ruleIndex",get:function(){return Ut.RULE_parse}}]),n}(_t.ParserRuleContext),Jt=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e,i){return Object(E.a)(this,n),t.call(this,e,i)}return Object(x.a)(n,[{key:"copyFrom",value:function(e){Object(Dt.a)(Object(Tt.a)(n.prototype),"copyFrom",this).call(this,e)}},{key:"ruleIndex",get:function(){return Ut.RULE_expression}}]),n}(_t.ParserRuleContext),Yt=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e.parent,e.invokingState)).copyFrom(e),i}return Object(x.a)(n,[{key:"NOT",value:function(){return this.getToken(Ut.NOT,0)}},{key:"expression",value:function(){return this.getRuleContext(0,Jt)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterNotExpression&&e.enterNotExpression(this)}},{key:"exitRule",value:function(e){e.exitNotExpression&&e.exitNotExpression(this)}},{key:"accept",value:function(e){return e.visitNotExpression?e.visitNotExpression(this):e.visitChildren(this)}}]),n}(Jt),Kt=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e.parent,e.invokingState))._left=void 0,i._right=void 0,i.copyFrom(e),i}return Object(x.a)(n,[{key:"OR",value:function(){return this.getToken(Ut.OR,0)}},{key:"expressionAnd",value:function(){return this.getRuleContext(0,$t)}},{key:"expression",value:function(){return this.getRuleContext(0,Jt)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterOrExpression&&e.enterOrExpression(this)}},{key:"exitRule",value:function(e){e.exitOrExpression&&e.exitOrExpression(this)}},{key:"accept",value:function(e){return e.visitOrExpression?e.visitOrExpression(this):e.visitChildren(this)}}]),n}(Jt),Qt=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e.parent,e.invokingState)).copyFrom(e),i}return Object(x.a)(n,[{key:"expressionAnd",value:function(){return this.getRuleContext(0,$t)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterAndParentExpression&&e.enterAndParentExpression(this)}},{key:"exitRule",value:function(e){e.exitAndParentExpression&&e.exitAndParentExpression(this)}},{key:"accept",value:function(e){return e.visitAndParentExpression?e.visitAndParentExpression(this):e.visitChildren(this)}}]),n}(Jt),$t=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e,i){return Object(E.a)(this,n),t.call(this,e,i)}return Object(x.a)(n,[{key:"copyFrom",value:function(e){Object(Dt.a)(Object(Tt.a)(n.prototype),"copyFrom",this).call(this,e)}},{key:"ruleIndex",get:function(){return Ut.RULE_expressionAnd}}]),n}(_t.ParserRuleContext),qt=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e.parent,e.invokingState))._left=void 0,i._right=void 0,i.copyFrom(e),i}return Object(x.a)(n,[{key:"AND",value:function(){return this.getToken(Ut.AND,0)}},{key:"expressionSimple",value:function(){return this.getRuleContext(0,Zt)}},{key:"expressionAnd",value:function(){return this.getRuleContext(0,$t)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterAndExpression&&e.enterAndExpression(this)}},{key:"exitRule",value:function(e){e.exitAndExpression&&e.exitAndExpression(this)}},{key:"accept",value:function(e){return e.visitAndExpression?e.visitAndExpression(this):e.visitChildren(this)}}]),n}($t),Xt=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e.parent,e.invokingState)).copyFrom(e),i}return Object(x.a)(n,[{key:"expressionSimple",value:function(){return this.getRuleContext(0,Zt)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterSimpleExpression&&e.enterSimpleExpression(this)}},{key:"exitRule",value:function(e){e.exitSimpleExpression&&e.exitSimpleExpression(this)}},{key:"accept",value:function(e){return e.visitSimpleExpression?e.visitSimpleExpression(this):e.visitChildren(this)}}]),n}($t),Zt=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e,i){return Object(E.a)(this,n),t.call(this,e,i)}return Object(x.a)(n,[{key:"copyFrom",value:function(e){Object(Dt.a)(Object(Tt.a)(n.prototype),"copyFrom",this).call(this,e)}},{key:"ruleIndex",get:function(){return Ut.RULE_expressionSimple}}]),n}(_t.ParserRuleContext),en=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e.parent,e.invokingState))._left=void 0,i._op=void 0,i._right=void 0,i.copyFrom(e),i}return Object(x.a)(n,[{key:"numExpression",value:function(e){return void 0===e?this.getRuleContexts(rn):this.getRuleContext(e,rn)}},{key:"comparator",value:function(){return this.getRuleContext(0,sn)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterComparatorExpression&&e.enterComparatorExpression(this)}},{key:"exitRule",value:function(e){e.exitComparatorExpression&&e.exitComparatorExpression(this)}},{key:"accept",value:function(e){return e.visitComparatorExpression?e.visitComparatorExpression(this):e.visitChildren(this)}}]),n}(Zt),tn=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e.parent,e.invokingState)).copyFrom(e),i}return Object(x.a)(n,[{key:"IDENTIFIER",value:function(){return this.getToken(Ut.IDENTIFIER,0)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterIdentifierExpression&&e.enterIdentifierExpression(this)}},{key:"exitRule",value:function(e){e.exitIdentifierExpression&&e.exitIdentifierExpression(this)}},{key:"accept",value:function(e){return e.visitIdentifierExpression?e.visitIdentifierExpression(this):e.visitChildren(this)}}]),n}(Zt),nn=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e.parent,e.invokingState)).copyFrom(e),i}return Object(x.a)(n,[{key:"LPAREN",value:function(){return this.getToken(Ut.LPAREN,0)}},{key:"expression",value:function(){return this.getRuleContext(0,Jt)}},{key:"RPAREN",value:function(){return this.getToken(Ut.RPAREN,0)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterParenExpression&&e.enterParenExpression(this)}},{key:"exitRule",value:function(e){e.exitParenExpression&&e.exitParenExpression(this)}},{key:"accept",value:function(e){return e.visitParenExpression?e.visitParenExpression(this):e.visitChildren(this)}}]),n}(Zt),rn=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e,i){return Object(E.a)(this,n),t.call(this,e,i)}return Object(x.a)(n,[{key:"copyFrom",value:function(e){Object(Dt.a)(Object(Tt.a)(n.prototype),"copyFrom",this).call(this,e)}},{key:"ruleIndex",get:function(){return Ut.RULE_numExpression}}]),n}(_t.ParserRuleContext),an=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e.parent,e.invokingState)).copyFrom(e),i}return Object(x.a)(n,[{key:"IDENTIFIER",value:function(){return this.getToken(Ut.IDENTIFIER,0)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterIdentifierNumExpression&&e.enterIdentifierNumExpression(this)}},{key:"exitRule",value:function(e){e.exitIdentifierNumExpression&&e.exitIdentifierNumExpression(this)}},{key:"accept",value:function(e){return e.visitIdentifierNumExpression?e.visitIdentifierNumExpression(this):e.visitChildren(this)}}]),n}(rn),on=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e.parent,e.invokingState)).copyFrom(e),i}return Object(x.a)(n,[{key:"DECIMAL",value:function(){return this.getToken(Ut.DECIMAL,0)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterDecimalExpression&&e.enterDecimalExpression(this)}},{key:"exitRule",value:function(e){e.exitDecimalExpression&&e.exitDecimalExpression(this)}},{key:"accept",value:function(e){return e.visitDecimalExpression?e.visitDecimalExpression(this):e.visitChildren(this)}}]),n}(rn),sn=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e,i){return Object(E.a)(this,n),t.call(this,e,i)}return Object(x.a)(n,[{key:"GT",value:function(){return this.tryGetToken(Ut.GT,0)}},{key:"GE",value:function(){return this.tryGetToken(Ut.GE,0)}},{key:"LT",value:function(){return this.tryGetToken(Ut.LT,0)}},{key:"LE",value:function(){return this.tryGetToken(Ut.LE,0)}},{key:"EQ",value:function(){return this.tryGetToken(Ut.EQ,0)}}]),Object(x.a)(n,[{key:"enterRule",value:function(e){e.enterComparator&&e.enterComparator(this)}},{key:"exitRule",value:function(e){e.exitComparator&&e.exitComparator(this)}},{key:"accept",value:function(e){return e.visitComparator?e.visitComparator(this):e.visitChildren(this)}},{key:"ruleIndex",get:function(){return Ut.RULE_comparator}}]),n}(_t.ParserRuleContext),cn=n(261),ln=n(80),un=n(148),pn=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this,e))._interp=new un.LexerATNSimulator(n._ATN,Object(Lt.a)(i)),i}return Object(x.a)(n,[{key:"vocabulary",get:function(){return n.VOCABULARY}}]),Object(x.a)(n,[{key:"grammarFileName",get:function(){return"SimpleBoolean.g4"}},{key:"ruleNames",get:function(){return n.ruleNames}},{key:"serializedATN",get:function(){return n._serializedATN}},{key:"channelNames",get:function(){return n.channelNames}},{key:"modeNames",get:function(){return n.modeNames}}],[{key:"_ATN",get:function(){return n.__ATN||(n.__ATN=(new Pt.ATNDeserializer).deserialize(Gt.toCharArray(n._serializedATN))),n.__ATN}}]),n}(ln.Lexer);pn.AND=1,pn.OR=2,pn.NOT=3,pn.TRUE=4,pn.FALSE=5,pn.GT=6,pn.GE=7,pn.LT=8,pn.LE=9,pn.EQ=10,pn.LPAREN=11,pn.RPAREN=12,pn.DECIMAL=13,pn.IDENTIFIER=14,pn.WS=15,pn.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"],pn.modeNames=["DEFAULT_MODE"],pn.ruleNames=["AND","OR","NOT","TRUE","FALSE","GT","GE","LT","LE","EQ","LPAREN","RPAREN","DECIMAL","IDENTIFIER","WS"],pn._LITERAL_NAMES=[void 0,"'AND'","'OR'","'NOT'","'TRUE'","'FALSE'","'>'","'>='","'<'","'<='","'='","'('","')'"],pn._SYMBOLIC_NAMES=[void 0,"AND","OR","NOT","TRUE","FALSE","GT","GE","LT","LE","EQ","LPAREN","RPAREN","DECIMAL","IDENTIFIER","WS"],pn.VOCABULARY=new Vt.VocabularyImpl(pn._LITERAL_NAMES,pn._SYMBOLIC_NAMES,[]),pn._serializedATN='\x03\uc91d\ucaba\u058d\uafba\u4f53\u0607\uea8b\uc241\x02\x11e\b\x01\x04\x02\t\x02\x04\x03\t\x03\x04\x04\t\x04\x04\x05\t\x05\x04\x06\t\x06\x04\x07\t\x07\x04\b\t\b\x04\t\t\t\x04\n\t\n\x04\v\t\v\x04\f\t\f\x04\r\t\r\x04\x0e\t\x0e\x04\x0f\t\x0f\x04\x10\t\x10\x03\x02\x03\x02\x03\x02\x03\x02\x03\x03\x03\x03\x03\x03\x03\x04\x03\x04\x03\x04\x03\x04\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x03\x06\x03\x06\x03\x06\x03\x06\x03\x06\x03\x06\x03\x07\x03\x07\x03\b\x03\b\x03\b\x03\t\x03\t\x03\n\x03\n\x03\n\x03\v\x03\v\x03\f\x03\f\x03\r\x03\r\x03\x0e\x05\x0eI\n\x0e\x03\x0e\x06\x0eL\n\x0e\r\x0e\x0e\x0eM\x03\x0e\x03\x0e\x06\x0eR\n\x0e\r\x0e\x0e\x0eS\x05\x0eV\n\x0e\x03\x0f\x03\x0f\x07\x0fZ\n\x0f\f\x0f\x0e\x0f]\v\x0f\x03\x10\x06\x10`\n\x10\r\x10\x0e\x10a\x03\x10\x03\x10\x02\x02\x02\x11\x03\x02\x03\x05\x02\x04\x07\x02\x05\t\x02\x06\v\x02\x07\r\x02\b\x0f\x02\t\x11\x02\n\x13\x02\v\x15\x02\f\x17\x02\r\x19\x02\x0e\x1b\x02\x0f\x1d\x02\x10\x1f\x02\x11\x03\x02\x06\x03\x022;\x05\x02C\\aac|\x06\x022;C\\aac|\x05\x02\v\f\x0e\x0f""\x02j\x02\x03\x03\x02\x02\x02\x02\x05\x03\x02\x02\x02\x02\x07\x03\x02\x02\x02\x02\t\x03\x02\x02\x02\x02\v\x03\x02\x02\x02\x02\r\x03\x02\x02\x02\x02\x0f\x03\x02\x02\x02\x02\x11\x03\x02\x02\x02\x02\x13\x03\x02\x02\x02\x02\x15\x03\x02\x02\x02\x02\x17\x03\x02\x02\x02\x02\x19\x03\x02\x02\x02\x02\x1b\x03\x02\x02\x02\x02\x1d\x03\x02\x02\x02\x02\x1f\x03\x02\x02\x02\x03!\x03\x02\x02\x02\x05%\x03\x02\x02\x02\x07(\x03\x02\x02\x02\t,\x03\x02\x02\x02\v1\x03\x02\x02\x02\r7\x03\x02\x02\x02\x0f9\x03\x02\x02\x02\x11<\x03\x02\x02\x02\x13>\x03\x02\x02\x02\x15A\x03\x02\x02\x02\x17C\x03\x02\x02\x02\x19E\x03\x02\x02\x02\x1bH\x03\x02\x02\x02\x1dW\x03\x02\x02\x02\x1f_\x03\x02\x02\x02!"\x07C\x02\x02"#\x07P\x02\x02#$\x07F\x02\x02$\x04\x03\x02\x02\x02%&\x07Q\x02\x02&\'\x07T\x02\x02\'\x06\x03\x02\x02\x02()\x07P\x02\x02)*\x07Q\x02\x02*+\x07V\x02\x02+\b\x03\x02\x02\x02,-\x07V\x02\x02-.\x07T\x02\x02./\x07W\x02\x02/0\x07G\x02\x020\n\x03\x02\x02\x0212\x07H\x02\x0223\x07C\x02\x0234\x07N\x02\x0245\x07U\x02\x0256\x07G\x02\x026\f\x03\x02\x02\x0278\x07@\x02\x028\x0e\x03\x02\x02\x029:\x07@\x02\x02:;\x07?\x02\x02;\x10\x03\x02\x02\x02<=\x07>\x02\x02=\x12\x03\x02\x02\x02>?\x07>\x02\x02?@\x07?\x02\x02@\x14\x03\x02\x02\x02AB\x07?\x02\x02B\x16\x03\x02\x02\x02CD\x07*\x02\x02D\x18\x03\x02\x02\x02EF\x07+\x02\x02F\x1a\x03\x02\x02\x02GI\x07/\x02\x02HG\x03\x02\x02\x02HI\x03\x02\x02\x02IK\x03\x02\x02\x02JL\t\x02\x02\x02KJ\x03\x02\x02\x02LM\x03\x02\x02\x02MK\x03\x02\x02\x02MN\x03\x02\x02\x02NU\x03\x02\x02\x02OQ\x070\x02\x02PR\t\x02\x02\x02QP\x03\x02\x02\x02RS\x03\x02\x02\x02SQ\x03\x02\x02\x02ST\x03\x02\x02\x02TV\x03\x02\x02\x02UO\x03\x02\x02\x02UV\x03\x02\x02\x02V\x1c\x03\x02\x02\x02W[\t\x03\x02\x02XZ\t\x04\x02\x02YX\x03\x02\x02\x02Z]\x03\x02\x02\x02[Y\x03\x02\x02\x02[\\\x03\x02\x02\x02\\\x1e\x03\x02\x02\x02][\x03\x02\x02\x02^`\t\x05\x02\x02_^\x03\x02\x02\x02`a\x03\x02\x02\x02a_\x03\x02\x02\x02ab\x03\x02\x02\x02bc\x03\x02\x02\x02cd\b\x10\x02\x02d \x03\x02\x02\x02\t\x02HMSU[a\x03\b\x02\x02',pn.__ATN=void 0;var dn,hn,fn,yn,bn,mn,vn,gn=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e){var i;return Object(E.a)(this,n),(i=t.call(this)).signals=e,i.isInvalid=!1,i.boolSignals=[],i}return Object(x.a)(n,[{key:"defaultResult",value:function(){return[]}},{key:"aggregateResult",value:function(e,t){return e.concat(t)}},{key:"visitErrorNode",value:function(e){return this.isInvalid?[]:(this.isInvalid=!0,["Invalid boolean expression"])}},{key:"visitIdentifierExpression",value:function(e){var t=this.signals.boolSignals.includes(e.text);return this.boolSignals.push(e),t?[]:["'".concat(e.text,"' is not a defined boolean signal")]}},{key:"visitIdentifierNumExpression",value:function(e){return this.signals.numSignals.includes(e.text)?[]:["'".concat(e.text,"' is not a defined numeric signal")]}},{key:"visitExpression",value:function(e){return void 0===e.exception||this.isInvalid?[]:(this.isInvalid=!0,["Invalid boolean expression"])}}]),n}(n(401).AbstractParseTreeVisitor),On=(dn=P.h.bound,hn=function(){function e(t,n){var i,r,a,s=this;Object(E.a)(this,e),this.connection=t,Object(T.a)(this,"conditionExpression",fn,this),Object(T.a)(this,"priority",yn,this),Object(T.a)(this,"isNegated",bn,this),Object(T.a)(this,"savedSignalsWithMemory",mn,this),this.errors=P.s.map(),this.spec={conditionExpression:new re({default:""})},Object(T.a)(this,"setPriority",vn,this),this.evaluateSignal=function(e){for(var t=!1,n=!1,i=e.parent;void 0!==i;)i instanceof Qt?n=!n:i instanceof Yt&&(t=!t),i=i.parent;return!1},this.ConnectionView=Object(w.a)((function(){var e,t;return o.a.createElement(o.a.Fragment,null,o.a.createElement(vt,{key:"table"},o.a.createElement("tr",{key:"priority"},o.a.createElement("td",null,"Priority"),o.a.createElement("td",null,o.a.createElement(U,{keys:s.priorityChoices,value:""+s.priority,setValue:s.setPriority}))),o.a.createElement("tr",{key:"condition"},o.a.createElement("td",null,"Condition"),o.a.createElement("td",null,o.a.createElement(En,{m:s}))),(s.from.type===ee.MACRO||s.from.type===ee.ENCLOSING)&&o.a.createElement("tr",{key:"isNegated"},o.a.createElement("td",null,"Negated"),o.a.createElement("td",null,o.a.createElement(ne.a,{checked:s.isNegated,onChange:function(){s.isNegated=!s.isNegated},color:"primary"})))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{style:{flex:1}},o.a.createElement("h4",{style:{margin:"0"}},"Errors"),0===(null===(e=s.parsedExpression)||void 0===e?void 0:e.errors.length)&&"No errors",o.a.createElement("ul",{style:{color:"indianred",marginTop:"0",paddingLeft:"20px"},key:"errors"},null===(t=s.parsedExpression)||void 0===t?void 0:t.errors.map((function(e,t){return o.a.createElement("li",{key:t},e)})))),(s.from.type===ee.MACRO&&!s.isNegated||s.from.type===ee.ENCLOSING&&s.isNegated)&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{width:"10px"}}),o.a.createElement("div",{style:{flex:1}},o.a.createElement("h4",{key:"title",style:{margin:"0"}},"With Memory"),0===s.signalsInCondition.length&&"No signals in transition",s.signalsInCondition.map((function(e){var t=s.savedSignalsWithMemory.has(e),n=Object(w.a)((function(){return o.a.createElement("div",{className:"row",style:{alignItems:"center"}},o.a.createElement("div",null,o.a.createElement(Rt.a,{checked:t,size:"small",color:"primary",onChange:function(){t?s.savedSignalsWithMemory.delete(e):s.savedSignalsWithMemory.add(e)}})),o.a.createElement("div",{style:{flex:1}},e))}));return o.a.createElement(n,{key:e})}))))))})),this.conditionExpression=null!==(i=null===n||void 0===n?void 0:n.conditionExpression)&&void 0!==i?i:"",this.priority=null!==(r=null===n||void 0===n?void 0:n.priority)&&void 0!==r?r:t.from.outputs.length+1,this.isNegated=null!==(a=null===n||void 0===n?void 0:n.isNegated)&&void 0!==a&&a}return Object(x.a)(e,[{key:"priorityChoices",get:function(){return Object(O.a)(Array(this.connection.from.outputs.length)).map((function(e,t){return""+(t+1)}))}}]),Object(x.a)(e,[{key:"from",get:function(){return this.connection.from.data}},{key:"to",get:function(){return this.connection.to.data}},{key:"connectionText",get:function(){var e=this.conditionExpression.substring(0,20),t=this.isNegated&&(this.from.type===ee.MACRO||this.from.type===ee.ENCLOSING);return[{text:t||this.from.type!==ee.CONTAINER&&this.connection.from.outputs.length>1?"".concat(this.priority,": "):"",style:{textDecoration:t?"overline":void 0}},{text:" ".concat(e).concat(this.conditionExpression.length>20?"...":"")}]}},{key:"toJson",get:function(){return{conditionExpression:this.conditionExpression,priority:this.priority,isNegated:this.isNegated}}},{key:"expressionTokens",get:function(){return function(e){var t,n=[],i=-1,r=0,a="",o=function(){0!==a.length&&(n.push([new kt(a),i-a.length]),a="")},s=function(e){o(),n.push([e,i])},c=Object(ge.a)(e);try{for(c.s();!(t=c.n()).done;){var l=t.value;if(i++,0===r)switch(l){case" ":o();break;case"\n":case")":case"(":case"<":case">":s(l);break;case"=":var u=n[n.length-1],p=u[0],d=p instanceof kt?p.text:p;["<",">"].includes(d)&&u[1]===i-1?n[n.length-1][0]=p+"=":s(l);break;case"A":if("AND"===e.substring(i,i+3)){r=2,s("AND");continue}case"O":if("OR"===e.substring(i,i+2)){r=1,s("OR");continue}case"N":if("NOT"===e.substring(i,i+3)){r=2,s("NOT");continue}default:a+=l}else r--}}catch(h){c.e(h)}finally{c.f()}return 0!==a.length&&n.push([new kt(a),i-a.length+1]),n}(this.conditionExpression)}},{key:"parsedExpression",get:function(){var e=this.connection.graph.globalData;try{var t=function(e,t){var n=cn.CharStreams.fromString(e),i=new pn(n),r=new cn.CommonTokenStream(i),a=new Ut(r).parse(),o=new gn(t),s=o.visit(a);void 0!==a.exception&&(o.isInvalid=!0,s.push("Invalid boolean expression"));var c=Object(O.a)(a.children);if(void 0!==c&&!o.isInvalid)for(var l=function(){var e=c.pop();if(e instanceof Jt&&void 0!==e.exception)return s.push("Invalid boolean expression"),"break";e.childCount>0&&(c=c.concat(Object(O.a)(Array(e.childCount).keys()).map((function(t){return e.getChild(t)}))))};0!==c.length;){if("break"===l())break}return{tree:a,errors:s,boolSignals:o.boolSignals}}(this.conditionExpression,{boolSignals:e.boolSignals.map((function(e){return e.name})),numSignals:e.numSignals.map((function(e){return e.name}))});return console.log(t.boolSignals),t}catch(n){}}},{key:"signalsInCondition",get:function(){var e=this;return void 0!==this.parsedExpression?this.parsedExpression.boolSignals.map((function(e){return e.text})):Object(O.a)(this.expressionTokens.map((function(e){var t=Object(h.a)(e,2),n=t[0];t[1];return n})).filter((function(t){return t instanceof kt&&e.from.automationSystem.signals.some((function(e){return e.name===t.toString()}))})).reduce((function(e,t){return e.add(t.toString()),e}),new Set).values())}},{key:"signalsInConditionWithDefault",get:function(){var e;return null===(e=this.parsedExpression)||void 0===e?void 0:e.boolSignals.map((function(e){return e.parent,[e.text,!1]}))}},{key:"signalsWithMemory",get:function(){var e=this;return this.signalsInCondition.filter((function(t){return e.savedSignalsWithMemory.has(t)}))}}]),e}(),fn=Object(L.a)(hn.prototype,"conditionExpression",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yn=Object(L.a)(hn.prototype,"priority",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bn=Object(L.a)(hn.prototype,"isNegated",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn=Object(L.a)(hn.prototype,"savedSignalsWithMemory",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new P.c}}),Object(L.a)(hn.prototype,"priorityChoices",[P.i],Object.getOwnPropertyDescriptor(hn.prototype,"priorityChoices"),hn.prototype),vn=Object(L.a)(hn.prototype,"setPriority",[dn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=parseInt(t);if(e.priority!==n){var i=e.connection.from.outputs;e.priority>n?i.filter((function(t){return t.data.priority>=n&&t.data.priority<e.priority})).forEach((function(e){return e.data.priority++})):i.filter((function(t){return t.data.priority<=n&&t.data.priority>e.priority})).forEach((function(e){return e.data.priority--})),e.priority=n}}}}),Object(L.a)(hn.prototype,"connectionText",[P.i],Object.getOwnPropertyDescriptor(hn.prototype,"connectionText"),hn.prototype),Object(L.a)(hn.prototype,"toJson",[P.i],Object.getOwnPropertyDescriptor(hn.prototype,"toJson"),hn.prototype),Object(L.a)(hn.prototype,"expressionTokens",[P.i],Object.getOwnPropertyDescriptor(hn.prototype,"expressionTokens"),hn.prototype),Object(L.a)(hn.prototype,"parsedExpression",[P.i],Object.getOwnPropertyDescriptor(hn.prototype,"parsedExpression"),hn.prototype),Object(L.a)(hn.prototype,"signalsInCondition",[P.i],Object.getOwnPropertyDescriptor(hn.prototype,"signalsInCondition"),hn.prototype),Object(L.a)(hn.prototype,"signalsInConditionWithDefault",[P.i],Object.getOwnPropertyDescriptor(hn.prototype,"signalsInConditionWithDefault"),hn.prototype),Object(L.a)(hn.prototype,"signalsWithMemory",[P.i],Object.getOwnPropertyDescriptor(hn.prototype,"signalsWithMemory"),hn.prototype),hn),En=Object(w.a)((function(e){var t=e.m,n=0,i=Object(a.useRef)(null),r="400 15px monospace";return o.a.createElement("div",{style:{width:"206px",position:"relative"},className:"center"},o.a.createElement("span",{style:{font:r,position:"absolute",top:0,padding:"3px",textAlign:"initial",whiteSpace:"pre-line"},ref:i},t.expressionTokens.map((function(e,t){var i,r=Object(h.a)(e,2),a=r[0],s=r[1];i=a instanceof kt?"black":["AND","NOT","OR"].includes(a)?"blue":"brown";var c=" ".repeat(s-n)+a.toString();return n=s+a.toString().length,o.a.createElement("span",{key:t,style:{color:i}},c)}))),o.a.createElement("textarea",{onScroll:function(e){i.current.scrollTo(0,e.currentTarget.scrollTop)},className:"multiline-input",style:{font:r,background:"transparent",color:"transparent",caretColor:"black",position:"relative"},spellCheck:!1,value:t.conditionExpression,onChange:function(e){var n=e.currentTarget.value;null===n.match(/^\s$/)&&(t.conditionExpression=n.replace(/\s[^\S\r\n]/g," "))}}))})),xn=n(783),jn=n(785),kn=n(782),wn=n(784),Nn=n(781),Cn=(n(392),function(){function e(t){Object(E.a)(this,e),this.name=t}return Object(x.a)(e,[{key:"when",value:function(e){this instanceof An?e.file(this):this instanceof In&&e.dir(this)}}]),e}()),An=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e,i){var r;return Object(E.a)(this,n),(r=t.call(this,e)).content=i,r}return n}(Cn),In=function(e){Object(j.a)(n,e);var t=Object(k.a)(n);function n(e,i){var r;return Object(E.a)(this,n),(r=t.call(this,e)).items=i,r}return n}(Cn),Sn=n(402),Rn=n.n(Sn);function Dn(){var e=Object(R.a)(["\n  z-index: 1;\n  cursor: pointer;\n  position: absolute;\n  box-shadow: 0 1px 4px 1px #eee;\n  background: #fff;\n  border-radius: 6;\n  border: 1.5px solid;\n"]);return Dn=function(){return e},e}var Tn,Ln,Pn,Fn,Mn,_n,zn,Hn,Bn,Vn,Gn,Un,Wn,Jn=H.a.div(Dn()),Yn=Object(w.a)((function(e){var t,n,i,r,a=e.node,s=e.children,c=ri(),l=o.a.useCallback((function(e,t){a.move(t.deltaX,t.deltaY)}),[a]),u=void 0!==c.selectingInputFor,p=u&&c.selectingInputFor.data.isValidInput(a),d=c.selectedNode===a,h=o.a.useCallback((function(e){console.log(a),u?p&&c.assignInput(a):c.selectNode(a)}),[c,a,u,p]);if(a.isHidden&&!c.showHidden)return o.a.createElement(o.a.Fragment,null);var f=a.x,y=a.y,b={};return d&&(b.boxShadow="rgb(110 110 110) 1px 1.5px 3px 1px"),u&&(b.cursor=p?"pointer":"not-allowed"),a.isHidden&&(b.opacity=.1),o.a.createElement(Rn.a,{onDrag:l,position:{x:f-(null!==(t=null===(n=a.data.parent)||void 0===n?void 0:n.x)&&void 0!==t?t:0),y:y-(null!==(i=null===(r=a.data.parent)||void 0===r?void 0:r.y)&&void 0!==i?i:0)},bounds:"parent"},o.a.createElement(Jn,{ref:function(e){null!==e&&a.setElement(e)},onClick:h,style:b},o.a.createElement(a.data.View,{children:s})))})),Kn=n(796);!function(e){e.bool="bool",e.int="int",e.uint="uint",e.real="real"}(Gn||(Gn={})),function(e){e.bool="bool",e.sint="sint",e.int="int",e.lint="lint",e.dint="dint",e.usint="usint",e.uint="uint",e.ulint="ulint",e.udint="udint",e.real="real",e.lreal="lreal"}(Un||(Un={})),function(e){e.s="s",e.i="i",e.l="l",e.d="d"}(Wn||(Wn={}));var Qn,$n=(Tn={},Object(D.a)(Tn,Un.bool,[Wn.i]),Object(D.a)(Tn,Un.int,Object(O.a)(Object.keys(Wn))),Object(D.a)(Tn,Un.uint,Object(O.a)(Object.keys(Wn))),Object(D.a)(Tn,Un.real,[Wn.i,Wn.l]),Tn),qn=Object(w.a)((function(e){var t=e.signal,n=e.showDelete,i=e.removeSignal;return o.a.createElement(Nn.a,null,o.a.createElement(kn.a,null,o.a.createElement(Kn.a,{title:void 0!==t.errors.Name?t.errors.Name:""},o.a.createElement(ie.a,{type:"text",value:t.name,onChange:function(e){return t.name=e.target.value},style:{width:"145px"},error:void 0!==t.errors.Name}))),o.a.createElement(kn.a,null,o.a.createElement(U,{keys:Object.keys(Gn),setValue:function(e){return t.setTypeBase(e)},value:t.typeBase})),o.a.createElement(kn.a,null,o.a.createElement(U,{keys:$n[t.typeBase],setValue:function(e){return t.typeSize=e},value:t.typeSize,maxButton:0})),o.a.createElement(kn.a,null,o.a.createElement(Kn.a,{title:void 0!==t.errors["Default Value"]?t.errors["Default Value"]:"",open:!0},o.a.createElement(ie.a,{type:t.typeBase===Gn.bool?"text":"number",value:t.defaultValue,onChange:function(e){t.defaultValue=e.target.value.replace(/\s/g,"")},style:{width:"70px"},error:void 0!==t.errors["Default Value"]}))),n&&o.a.createElement(kn.a,{align:"center"},o.a.createElement(Et.a,{onClick:function(e){return i(t)},size:"small"},o.a.createElement(xt.a,{icon:"trash-alt",color:"#000"}))))})),Xn=(Ln={},Object(D.a)(Ln,Gn.bool,{regex:/^(TRUE|FALSE)$/,message:'should be "TRUE" or "FALSE"'}),Object(D.a)(Ln,Gn.int,{regex:/^(-?[1-9][0-9]*|0)$/,message:"should be an integer"}),Object(D.a)(Ln,Gn.uint,{regex:/^([1-9][0-9]*|0)$/,message:"should be a positive integer"}),Object(D.a)(Ln,Gn.real,{regex:/^-?[0-9]*\.?[0-9]+$/,message:"should be a number"}),Ln),Zn=(Pn=P.h.bound,Fn=function(){function e(t,n){var i,r,a,o;Object(E.a)(this,e),this.automationSystem=t,Object(T.a)(this,"didBlur",Mn,this),Object(T.a)(this,"name",_n,this),Object(T.a)(this,"defaultValue",zn,this),Object(T.a)(this,"typeSize",Hn,this),Object(T.a)(this,"typeBase",Bn,this),Object(T.a)(this,"setTypeBase",Vn,this),this.description=void 0,this.name=null!==(i=null===n||void 0===n?void 0:n.name)&&void 0!==i?i:"",this.description=null===n||void 0===n?void 0:n.description;var s=function(e){if(void 0!==e){switch(e){case Un.bool:return{base:Gn.bool,size:Wn.i};case Un.real:return{base:Gn.real,size:Wn.i};case Un.lreal:return{base:Gn.real,size:Wn.l}}var t,n;e.startsWith("u")?(t=Gn.uint,n=1):(t=Gn.int,n=0);var i=e.charAt(n);if(Object.keys(Wn).includes(i))return{base:t,size:i}}}(null===n||void 0===n?void 0:n.type);this.typeBase=null!==(r=null===s||void 0===s?void 0:s.base)&&void 0!==r?r:Gn.bool,this.typeSize=null!==(a=null===s||void 0===s?void 0:s.size)&&void 0!==a?a:Wn.i,this.defaultValue=null!==(o=null===n||void 0===n?void 0:n.defaultValue)&&void 0!==o?o:""}return Object(x.a)(e,[{key:"type",get:function(){if(this.typeBase===Gn.bool)return Un.bool;var e=this.typeSize===Wn.i?"":this.typeSize;return this.typeBase.startsWith("u")?"u"+e+this.typeBase.substring(1):e+this.typeBase}},{key:"errors",get:function(){var e=this,t=-1!==this.automationSystem.signals.findIndex((function(t){return t.name===e.name&&e!==t}))?"Duplicate name":void 0,n=Xn[this.typeBase];return{Name:t,"Default Value":0!==this.defaultValue.length&&!n.regex.test(this.defaultValue)?n.message:void 0}}},{key:"toJson",get:function(){return{name:this.name,type:this.type,defaultValue:this.defaultValue}}}],[{key:"fromJson",value:function(t,n){return"string"===typeof n.name&&Object.keys(Un).includes(n.type)?new e(t,n):void 0}}]),e}(),Mn=Object(L.a)(Fn.prototype,"didBlur",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_n=Object(L.a)(Fn.prototype,"name",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zn=Object(L.a)(Fn.prototype,"defaultValue",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hn=Object(L.a)(Fn.prototype,"typeSize",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bn=Object(L.a)(Fn.prototype,"typeBase",[P.s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(L.a)(Fn.prototype,"type",[P.i],Object.getOwnPropertyDescriptor(Fn.prototype,"type"),Fn.prototype),Vn=Object(L.a)(Fn.prototype,"setTypeBase",[Pn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.typeBase=t,$n[t].includes(e.typeSize)||(e.typeSize=$n[t][0])}}}),Object(L.a)(Fn.prototype,"errors",[P.i],Object.getOwnPropertyDescriptor(Fn.prototype,"errors"),Fn.prototype),Object(L.a)(Fn.prototype,"toJson",[P.i],Object.getOwnPropertyDescriptor(Fn.prototype,"toJson"),Fn.prototype),Fn),ei=(Qn=function(){function e(t,n){var i=this;Object(E.a)(this,e),this.graph=t,this.canAddNode=function(e){return!0},this.fFamily=void 0,this.aFamily=void 0,this.dFamily=void 0,this.signals=void 0,this.View=Object(w.a)((function(){var e=Object(a.useState)(!1),t=Object(h.a)(e,2),n=t[0],r=t[1];return o.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},o.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},o.a.createElement("h3",{style:{margin:"5px 0 10px 5px"}},"Signals"),o.a.createElement(f.a,{onClick:function(e){return r(!n)}},n?"Hide Delete":"Show Delete",o.a.createElement(xt.a,{style:{paddingLeft:"7px"},icon:"trash-alt",color:"#000"}))),o.a.createElement(xn.a,{id:"signals-table",size:"small","aria-label":"a dense table",stickyHeader:!0},o.a.createElement(wn.a,null,o.a.createElement(Nn.a,null,o.a.createElement(kn.a,null,"Name"),o.a.createElement(kn.a,null,"Type"),o.a.createElement(kn.a,null,"Size"),o.a.createElement(kn.a,null,"Default"),n&&o.a.createElement(kn.a,null,"Delete"))),o.a.createElement(jn.a,null,i.signals.map((function(e,t){return o.a.createElement(qn,{signal:e,key:t,showDelete:n,removeSignal:function(e){return i.signals.remove(e)}})})))),o.a.createElement(f.a,{style:{alignSelf:"flex-end"},onClick:function(e){return i.signals.push(new Zn(i))}},"Add Signal"))})),this.CanvasView=Object(w.a)((function(){var e,t=Object(O.a)(i.graph.nodes.values()),n=(e={},Object(D.a)(e,te.A,{color:"#ecf5ff",size:{w:600,h:500}}),Object(D.a)(e,te.D,{color:"#ffd6d6",size:{w:600,h:500}}),Object(D.a)(e,te.F,{color:"#ebffec",size:{w:600,h:1e3}}),e);return o.a.createElement("div",{style:{width:"100%",height:"100%",position:"absolute"}},t.filter((function(e){return e.data.type===ee.CONTAINER})).map((function(e){var i,r=n[e.data.family];return o.a.createElement("div",{style:{background:r.color,width:r.size.w,height:r.size.h,position:"absolute",top:e.y,left:e.x},key:e.key,ref:function(t){null!==t&&e.setSize(t.getBoundingClientRect())}},(i=e.data.family,t.filter((function(e){return e.data.family===i&&e.data.type!==ee.CONTAINER})).map((function(e){return o.a.createElement(Yn,{node:e,key:e.key})}))))})))}));var r=[];Array.isArray(null===n||void 0===n?void 0:n.signals)&&(r=null===n||void 0===n?void 0:n.signals.map((function(e){return"object"===typeof e?Zn.fromJson(i,e):void 0})).filter((function(e){return void 0!==e}))),this.signals=P.s.array(r)}return Object(x.a)(e,[{key:"initState",value:function(){var e,t,n,i=Object(O.a)(this.graph.nodes.values()),r=i.find((function(e){return e.data.type!==ee.CONTAINER&&!e.isHidden}));void 0!==r&&this.graph.selectNode(r);var a=i.flatMap((function(e){return e.inputs})).find((function(e){return!e.isHidden}));void 0!==a&&this.graph.selectConnection(a),this.fFamily=null!==(e=i.find((function(e){return e.data.type===ee.CONTAINER&&e.data.family===te.F})))&&void 0!==e?e:this.graph.addNode(ee.CONTAINER,{x:600,y:0}),this.fFamily.setName("F family"),this.fFamily.data.family=te.F,this.aFamily=null!==(t=i.find((function(e){return e.data.type===ee.CONTAINER&&e.data.family===te.A})))&&void 0!==t?t:this.graph.addNode(ee.CONTAINER,{x:0,y:0}),this.aFamily.setName("A family"),this.aFamily.data.family=te.A,this.dFamily=null!==(n=i.find((function(e){return e.data.type===ee.CONTAINER&&e.data.family===te.D})))&&void 0!==n?n:this.graph.addNode(ee.CONTAINER,{x:0,y:500}),this.dFamily.setName("D family"),this.dFamily.data.family=te.D}},{key:"steps",get:function(){return Object(O.a)(this.graph.nodes.values()).filter((function(e){return!e.isHidden&&e.data.type!==ee.CONTAINER})).sort((function(e,t){return e.data.id-t.data.id})).map((function(e){return e.data}))}},{key:"numSignals",get:function(){return this.signals.filter((function(e){return e.type!==Un.bool}))}},{key:"boolSignals",get:function(){return this.signals.filter((function(e){return e.type===Un.bool}))}},{key:"initialStep",get:function(){return this.steps.find((function(e){return e.isInitial}))}},{key:"generateMainFile",get:function(){return St(this)}},{key:"generateSourceCode",get:function(){var e,t,n=St(this),i=(e=this.signals,"VAR_GLOBAL\n    ".concat(e.map((function(e){return"".concat(e.name," : ").concat(e.type.toUpperCase()).concat(0===e.defaultValue.trim().length?"":" :="+e.defaultValue,";")})).join("\n    "),"\nEND_VAR\n")),r=[new An("GEMMA.txt",n),new An("GVL.txt",i)],a=Object(ge.a)(this.steps.values());try{for(a.s();!(t=a.n()).done;){var o=t.value;o.type!==ee.ENCLOSING&&o.type!==ee.MACRO||r.push(new An(o.name+"_FB.txt","FUNCTION_BLOCK ".concat(o.name,"_FB\n\n// Variable declaration\nVAR_INPUT\n  Initialization:BOOL;\nEND_VAR\n\nVAR_OUTPUT\n  Complete:BOOL;\nEND_VAR\n\n// FB behavior\nIF Initialization THEN\n  Complete:=FALSE;\n  //Initialization actions\n\nEND_IF\n\n//Nested behavior\n\n//Termination of the nested behavior\nComplete:=TRUE;\n")))}}catch(s){a.e(s)}finally{a.f()}return new In("gemma_grafcet",r)}},{key:"warnings",get:function(){var e,t=[],n=Object(ge.a)(this.signals);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.errors.Name&&t.push("".concat(i.name,". Name: ").concat(i.errors.Name,".")),i.errors["Default Value"]&&t.push("".concat(i.name,". Default value: ").concat(i.errors["Default Value"],"."))}}catch(c){n.e(c)}finally{n.f()}var r=this.steps.some((function(e){return e.isInitial})),a=this.steps.filter((function(e){return!e.node.inputs.some((function(e){return!e.isHidden}))})),o=this.steps.filter((function(e){return!e.node.outputs.some((function(e){return!e.isHidden}))})),s=[];return r||s.push("No initial step."),0!==o.length&&s.push("Steps with no output transitions: ".concat(o.map((function(e){return e.name})).join(", "))),0!==a.length&&s.push("Steps with no input transitions: ".concat(a.map((function(e){return e.name})).join(", "))),{Steps:s,Transitions:this.steps.flatMap((function(e){return e.transitions})).filter((function(e){var t,n;return void 0!==(null===(t=e.parsedExpression)||void 0===t?void 0:t.errors)&&(null===(n=e.parsedExpression)||void 0===n?void 0:n.errors.length)>0})).map((function(e){var t;return["".concat(e.from.name," -> ").concat(e.to.name),null===(t=e.parsedExpression)||void 0===t?void 0:t.errors]})),Signals:t}}},{key:"toJson",get:function(){return{signals:this.signals.map((function(e){return e.toJson}))}}}]),e}(),Object(L.a)(Qn.prototype,"steps",[P.i],Object.getOwnPropertyDescriptor(Qn.prototype,"steps"),Qn.prototype),Object(L.a)(Qn.prototype,"numSignals",[P.i],Object.getOwnPropertyDescriptor(Qn.prototype,"numSignals"),Qn.prototype),Object(L.a)(Qn.prototype,"boolSignals",[P.i],Object.getOwnPropertyDescriptor(Qn.prototype,"boolSignals"),Qn.prototype),Object(L.a)(Qn.prototype,"initialStep",[P.i],Object.getOwnPropertyDescriptor(Qn.prototype,"initialStep"),Qn.prototype),Object(L.a)(Qn.prototype,"generateMainFile",[P.i],Object.getOwnPropertyDescriptor(Qn.prototype,"generateMainFile"),Qn.prototype),Object(L.a)(Qn.prototype,"generateSourceCode",[P.i],Object.getOwnPropertyDescriptor(Qn.prototype,"generateSourceCode"),Qn.prototype),Object(L.a)(Qn.prototype,"warnings",[P.i],Object.getOwnPropertyDescriptor(Qn.prototype,"warnings"),Qn.prototype),Object(L.a)(Qn.prototype,"toJson",[P.i],Object.getOwnPropertyDescriptor(Qn.prototype,"toJson"),Qn.prototype),Qn),ti={graphBuilder:function(e,t){return new ei(e,t)},nodeBuilder:function(e,t){console.log(t);var n=void 0!==t?t.type:void 0;return"string"===typeof n&&Object.keys(ee).includes(n)?new oe(e,t):new oe(e)},connectionBuilder:function(e,t){return new On(e,t)}},ni=function(e){for(var t,n=new bt({db:e,builders:ti,hideOnDelete:!0}),i=(t={},Object(D.a)(t,te.A,{A1:{type:ee.SIMPLE,x:517,y:142},A2:{type:ee.SIMPLE,x:240,y:417},A3:{type:ee.SIMPLE,x:418,y:406},A4:{type:ee.SIMPLE,x:479,y:314},A5:{type:ee.MACRO,x:86,y:325},A6:{type:ee.SIMPLE,x:156,y:31},A7:{type:ee.MACRO,x:239,y:176}}),Object(D.a)(t,te.F,{F1:{type:ee.MACRO,x:743,y:709},F2:{type:ee.MACRO,x:966,y:683},F3:{type:ee.MACRO,x:704,y:171},F4:{type:ee.ENCLOSING,x:848,y:29},F5:{type:ee.ENCLOSING,x:979,y:478},F6:{type:ee.ENCLOSING,x:729,y:876}}),Object(D.a)(t,te.D,{D1:{type:ee.MACRO,x:75,y:895},D2:{type:ee.SIMPLE,x:221,y:573},D3:{type:ee.ENCLOSING,x:309,y:735}}),t),r={},a=0,o=Object.entries(i);a<o.length;a++)for(var s=Object(h.a)(o[a],2),c=s[0],l=s[1],u=0,p=Object.entries(l);u<p.length;u++){var d=Object(h.a)(p[u],2),f=d[0],y=d[1],b=n.addNode(y.type,{x:y.x,y:y.y});null===b||void 0===b||b.setName(f),b.data.family=c,r[f]=b,"A6"===f&&(b.data.isInitial=!0)}for(var m=0,v=Object.entries({A1:["F2","F1","F5","F4"],A2:["A1"],A3:["A4"],A4:["F1"],A5:["A6","A7"],A6:["A1"],A7:["A4"],F1:["F3","F4","F5","F6","A2","A3","D1","D2","D3"],F2:["F1"],F3:["A1"],F4:["A6"],F5:["F1","F4"],F6:["F1","D1"],D1:["D2","A5"],D2:["A5"],D3:["A2","A3"]});m<v.length;m++){var g,O=Object(h.a)(v[m],2),E=O[0],x=O[1],j=Object(ge.a)(x);try{for(j.s();!(g=j.n()).done;){var k=g.value;n.addConnection(r[E],r[k])}}catch(N){j.e(N)}finally{j.f()}}n.addConnection(n.globalData.fFamily,r.D1,{conditionExpression:"I1 AND I2"});var w=r.A1;return n.selectNode(w),n.selectConnection(w.outputs[0]),n},ii=o.a.createContext(null);function ri(){var e=o.a.useContext(ii);if(!e)throw Error("useStore should be used inside a Store provider.");return e}function ai(){var e=o.a.useState(null),t=Object(h.a)(e,2),n=t[0],i=t[1],r=o.a.useState(null),a=Object(h.a)(r,2),s=a[0],c=a[1],l=s&&s.resetStore;return o.a.useEffect((function(){s?s.resetStore&&c(null):function(){return je.apply(this,arguments)}().then(function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(t),e.next=3,t.fetchGraphs();case 3:if(n=e.sent,void 0===(a=n[0])){e.next=12;break}return e.next=8,t.loadGraph(a.key);case 8:o=e.sent,r=new bt({db:t,json:Object(p.a)({graph:a},o),hideOnDelete:!0,builders:ti}),e.next=13;break;case 12:r=ni(t);case 13:window.store=r,c(r);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[s,l]),s?o.a.createElement(ii.Provider,{value:s},o.a.createElement("div",{className:"row",style:{background:"rgba(250,250,250,0.7)",height:"100%"}},o.a.createElement("div",{className:"col",style:{width:"0px",background:"rgba(250,250,250,0.7)",flex:"1 0 auto"}},o.a.createElement("div",{className:"row",style:{minHeight:0,flex:1}},o.a.createElement("div",{className:"col",style:{flex:1}},o.a.createElement(si,{store:s,globalDB:n,setStore:c}),o.a.createElement(ve,null)),o.a.createElement(Ee,null)),o.a.createElement(jt,null)))):o.a.createElement("div",{className:"center"},"Loading...")}var oi=Object(w.a)((function(e){var t=e.store;return o.a.createElement(f.a,{onClick:function(e){t.showHidden=!t.showHidden}},t.showHidden?"Hide Deleted":"Show Deleted")}));function si(e){var t=e.store,n=e.setStore,i=e.globalDB,r=Object(a.useState)(!1),s=Object(h.a)(r,2),c=s[0],l=s[1],p=Object(a.useState)(!1),O=Object(h.a)(p,2),E=O[0],x=O[1],j=Object(a.useCallback)((function(){l(!c)}),[c]);return o.a.createElement("div",{className:"row",style:{justifyContent:"space-between",borderBottom:"rgb(221 220 220) solid 1.5px"}},o.a.createElement(oi,{store:t}),o.a.createElement("div",{className:"row",style:{justifyContent:"flex-end"}},o.a.createElement(f.a,{onClick:function(e){t.saveModel()}},"Save"),o.a.createElement(f.a,{onClick:j},"Reset"),o.a.createElement(y.a,{open:c,onClose:j,keepMounted:!0,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description"},o.a.createElement(m.a,{id:"alert-dialog-slide-title"},"Reset Diagram State"),o.a.createElement(b.a,null,o.a.createElement(g.a,{id:"alert-dialog-slide-description"},"Are you sure you want to reset the diagram state? All changes will be lost.")),o.a.createElement(v.a,null,o.a.createElement(f.a,{onClick:j,color:"primary"},"Close"),o.a.createElement(f.a,{onClick:function(){var e=Object(d.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=ni(i),n(r),j();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),color:"primary"},"Reset Diagram"))),o.a.createElement(f.a,{onClick:function(e){Object.values(t.globalData.warnings).some((function(e){return e.length>0}))?x(!0):t.downloadModel()}},"Export"),o.a.createElement(ci,{open:E,toggleDialog:function(){return x(!E)},warnings:t.globalData.warnings,accept:t.downloadModel}),o.a.createElement(f.a,null,o.a.createElement("label",{htmlFor:"import-file-input",style:{margin:0,width:"100%",cursor:"pointer"}},"Import"),o.a.createElement("input",{type:"file",id:"import-file-input",accept:"application/json",style:{display:"none"},onChange:function(){var e=Object(d.a)(u.a.mark((function e(t){var r,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(t);case 2:if("string"===typeof(r=e.sent))try{a=JSON.parse(r),o=new bt({db:i,json:a,builders:ti,hideOnDelete:!0}),n(o)}catch(t){console.log(t)}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}))))}var ci=function(e){var t=e.open,n=e.toggleDialog,i=e.warnings,r=e.accept;return o.a.createElement(y.a,{open:t,onClose:n,keepMounted:!0,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description"},o.a.createElement(m.a,{id:"alert-dialog-slide-title"},"Download Diagram"),o.a.createElement(b.a,null,o.a.createElement(g.a,{id:"alert-dialog-slide-description"},"There are some warnings in the diagram configuration. Do you want to continue with the download?"),Object.entries(i).map((function(e){var t=Object(h.a)(e,2),n=t[0],i=t[1];return 0===i.length?o.a.createElement(o.a.Fragment,null):o.a.createElement("div",{key:n,className:"warning-list"},o.a.createElement("h3",null,n),o.a.createElement("ul",null,2===i[0].length&&Array.isArray(i[0][1])?o.a.createElement(o.a.Fragment,null,i.map((function(e,t){var n=Object(h.a)(e,2),i=n[0],r=n[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement("h5",{key:i},i),r.map((function(e,t){return o.a.createElement("li",{key:"".concat(i).concat(t)},e)})))}))):o.a.createElement(o.a.Fragment,null,i.map((function(e,t){return o.a.createElement("li",{key:t},e)})))))}))),o.a.createElement(v.a,null,o.a.createElement(f.a,{onClick:n,color:"primary"},"Close"),o.a.createElement(f.a,{onClick:r,color:"primary"},"Continue")))};n(730),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.b.add(r.a,r.b,r.e,r.c,r.d),c.a.render(o.a.createElement(ai,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[424,1,2]]]);
//# sourceMappingURL=main.26922bfe.chunk.js.map