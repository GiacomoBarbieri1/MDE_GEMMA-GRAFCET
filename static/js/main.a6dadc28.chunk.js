(this["webpackJsonpgemma-grafcet"]=this["webpackJsonpgemma-grafcet"]||[]).push([[0],{200:function(e,t,n){e.exports=n(284)},214:function(e,t,n){},283:function(e,t,n){},284:function(e,t,n){"use strict";n.r(t);var r=n(99),i=n(121),a=n(0),o=n.n(a),s=n(22),c=n.n(s),u=n(15),l=n.n(u),p=n(27),h=n(29),d=n(21),f=n(285),y=n(33),b=n(20),v=n(81),m=n(186),O=n.n(m),g=n(82);function E(){var e=Object(v.a)(["\n  z-index: 1;\n  cursor: pointer;\n  position: absolute;\n  box-shadow: 0 1px 4px 1px #eee;\n  background: #fff;\n  border-radius: 6;\n  border: 1.5px solid;\n"]);return E=function(){return e},e}var x=g.a.div(E()),j=Object(b.a)((function(e){var t=e.node,n=nn(),r=o.a.useCallback((function(e,n){t.move(n.deltaX,n.deltaY)}),[t]),i=void 0!==n.selectingInputFor,a=i&&n.selectingInputFor.data.isValidInput(t),s=n.selectedNode===t,c=o.a.useCallback((function(e){console.log(t),i?a&&n.assignInput(t):n.selectNode(t)}),[n,t,i,a]),u=t.x,l=t.y,p={};return s&&(p.boxShadow="rgb(110 110 110) 1px 1.5px 3px 1px"),i&&(p.cursor=a?"pointer":"not-allowed"),o.a.createElement(O.a,{onDrag:r,position:{x:u,y:l},bounds:"parent"},o.a.createElement(x,{ref:function(e){null!==e&&t.setSize(e.getBoundingClientRect())},onClick:c,style:p},o.a.createElement(t.data.View,null)))})),k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:14,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:14,i=t+n;return"M".concat(e," ").concat(t," L").concat(e-r/2," ").concat(i," L").concat(e+r/2," ").concat(i," Z")},w=Object(b.a)((function(e){var t,n,r=e.connection,i=nn(),a=r.from,s=r.to,c=r.isSelected,u=a.x+a.width/2,l=a.y+a.height/2,p=s.x+s.width/2,h=s.y+s.height/2,f=h-l,y=p-u;if(0===y)t=0,n=(h>l?1:-1)*s.height/2;else if(0===f)n=0,t=(p>u?1:-1)*s.width/2;else{var b=Math.abs(f/y),v=b>s.height/s.width?[s.height/2/b,s.height/2]:[s.width/2,s.width/2*b],m=Object(d.a)(v,2),O=m[0];n=(h>l?1:-1)*m[1],t=(p>u?1:-1)*O}var g=p-t,E=h-n,x=(u+p)/2,j=(l+h)/2,w=90+180*Math.atan2(h-l,p-u)/Math.PI;return o.a.createElement(o.a.Fragment,null,o.a.createElement("path",{style:{strokeWidth:2,stroke:"black"},d:"M".concat(u," ").concat(l," L").concat(p," ").concat(h),onClick:function(e){i.selectConnection(r)}}),o.a.createElement(N,{text:r.data.connectionText,x:x,rectFill:c?"#eeedff":"#eee",y:j,onClick:function(e){return i.selectConnection(r)}}),o.a.createElement("path",{d:k(g,E),transform:"rotate(".concat(w," ").concat(g," ").concat(E,")")}))})),N=Object(b.a)((function(e){var t=e.text,n=e.x,r=e.y,i=e.rectFill,a=void 0===i?"#eee":i,s=e.padding,c=void 0===s?3:s,u=e.onClick,l=o.a.useState(null),p=Object(d.a)(l,2),h=p[0],f=p[1],y=o.a.useState(t),b=Object(d.a)(y,2),v=b[0],m=b[1],O=null===h||void 0===h?void 0:h.getBBox();return o.a.useEffect((function(){if(v!==t){var e=setTimeout((function(){return m(t)}),0);return function(){return clearTimeout(e)}}})),o.a.createElement(o.a.Fragment,null,void 0!==O&&o.a.createElement("rect",{width:O.width+2*c,height:O.height+2*c,x:n-O.width/2-c,y:r-O.height+c,fill:a,onClick:u,style:{cursor:"pointer"}}),o.a.createElement("text",{x:void 0!==O?n-O.width/2:n,y:r,fill:"black",ref:f,onClick:u,style:{cursor:"pointer"}},t))})),A=Object(b.a)((function(){var e=nn(),t=Object(y.a)(e.nodes.values());return o.a.createElement("div",{style:{overflow:"auto",flex:"1"}},o.a.createElement("div",{style:{position:"relative",border:"1px solid #eee",background:"#fff",margin:"10px",borderRadius:"6px",flex:1,height:"1500px",width:"1500px"}},t.map((function(e){return console.log(e),o.a.createElement(j,{node:e,key:e.key})})),o.a.createElement("svg",{style:{width:"100%",height:"100%"}},t.flatMap((function(e){return e.inputs})).map((function(e){return o.a.createElement(w,{connection:e,key:e.from.key+e.to.key})})))))})),I=n(37),R=n(120);var C={top:!1,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1};function S(e){return Object.entries(e).reduce((function(e,t){var n=Object(d.a)(t,2),r=n[0],i=n[1];return void 0!==i&&(e[r]=i),e}),Object(p.a)({},C))}function L(e){var t=e.target.files;return new Promise((function(e,n){if(null!==t){var r=t[0];if("application/json"!==r.type)return window.alert("Debes seleccionar un archivo v\xe1lido, la extensi\xf3n debe ser '.json'."),e(void 0);var i=new FileReader;i.onload=function(t){var n;e(null===(n=t.target)||void 0===n?void 0:n.result)},i.onabort=function(t){e(void 0)},i.onerror=function(t){e(void 0)},i.readAsText(r)}else e(void 0)}))}var T,_=Object(b.a)((function(){for(var e=nn(),t=Object(y.a)(e.nodes.values()),n=t.reduce((function(e,t){return t.inputs.forEach((function(n){var r=e.get(n.to);void 0===r&&(r=[],e.set(n.to,r)),r.push(t)})),e}),new Map),r=[],i=new Map(t.filter((function(e){var t=0!==e.data.length;return t||r.push(e),t})).map((function(e){return[e,e.data.length]}))),a=0;0!==i.size&&r.length!==a;){var s,c=Object(I.a)(r.slice(a));try{for(c.s();!(s=c.n()).done;){var u=s.value;a+=1;var l=n.get(u);if(void 0!==l){var p,h=Object(I.a)(l);try{for(h.s();!(p=h.n()).done;){var d=p.value,f=i.get(d);1===f?(i.delete(d),r.push(d)):i.set(d,f-1)}}catch(b){h.e(b)}finally{h.f()}}}}catch(b){c.e(b)}finally{c.f()}}return i.size,o.a.createElement(R.a,{minWidth:200,defaultSize:{height:"auto",width:250},style:{position:"relative",background:"white",boxShadow:"0 1px 4px 1px #eee",border:"1px solid #eee"},enable:S({left:!0})},o.a.createElement("div",{style:{overflow:"auto",height:"100%",padding:"0 10px"}},o.a.createElement("pre",null,e.globalData.generateCode())))})),D=n(12),F=n(13),P=n(191);function M(){return(M=Object(h.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(P.a)("GemmaGrafcet",1,{upgrade:function(e){e.createObjectStore(T.graph,{keyPath:"key",autoIncrement:!1}),e.createObjectStore(T.node,{keyPath:"key",autoIncrement:!1}).createIndex("by-graph","graphKey"),e.createObjectStore(T.connection,{keyPath:"key",autoIncrement:!1}).createIndex("by-graph","graphKey")}});case 2:return t=e.sent,e.abrupt("return",new fe(t));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){return"".concat(e.from,"_").concat(e.to)}function G(e,t){return Object.assign(t,{key:z(t),graphKey:e})}!function(e){e.graph="graph",e.node="node",e.connection="connection"}(T||(T={}));var U,J,V,B,H,W,K,Y,Q,$,Z,X,q,ee,te,ne,re,ie,ae,oe,se,ce,ue,le,pe,he,de,fe=function(){function e(t){Object(D.a)(this,e),this.db=t}return Object(F.a)(e,[{key:"fetchGraphs",value:function(){return this.db.getAll(T.graph)}},{key:"updateGraph",value:function(e){return this.db.put(T.graph,e)}},{key:"deleteGraph",value:function(){var e=Object(h.a)(l.a.mark((function e(t){var n,r,i,a,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.db.transaction([T.graph,T.node,T.connection],"readwrite")).objectStore(T.graph).delete(t),r=Object(I.a)([T.node,T.connection]),e.prev=3,r.s();case 5:if((i=r.n()).done){e.next=19;break}return a=i.value,e.next=9,n.objectStore(a).index("by-graph").openCursor(t);case 9:o=e.sent;case 10:if(!o){e.next=17;break}return o.delete(),e.next=14,o.continue();case 14:o=e.sent,e.next=10;break;case 17:e.next=5;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(3),r.e(e.t0);case 24:return e.prev=24,r.f(),e.finish(24);case 27:return e.next=29,n.done;case 29:case"end":return e.stop()}}),e,this,[[3,21,24,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"loadGraph",value:function(){var e=Object(h.a)(l.a.mark((function e(t){var n,r,i,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.db.getAllFromIndex(T.node,"by-graph",t),this.db.getAllFromIndex(T.connection,"by-graph",t)]);case 2:return n=e.sent,r=Object(d.a)(n,2),i=r[0],a=r[1],e.abrupt("return",{nodes:i,connections:a});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addNodes",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){var r,i,a,o,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.db.transaction(T.node,"readwrite"),i={graphKey:t},a=Object(I.a)(n);try{for(a.s();!(o=a.n()).done;)s=o.value,r.store.add(Object.assign(s,i))}catch(c){a.e(c)}finally{a.f()}return e.next=6,r.done;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteNode",value:function(e){return this.db.delete(T.node,e.key)}},{key:"updateNode",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.db.put(T.node,Object.assign(n,{graphKey:t})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateNodes",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={graphKey:t},e.abrupt("return",this.updateMany(T.node,n.map((function(e){return e.key})),n.map((function(e){return Object.assign(e,r)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addConnections",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){var r,i,a,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.db.transaction(T.connection,"readwrite"),i=Object(I.a)(n);try{for(i.s();!(a=i.n()).done;)o=a.value,r.store.add(G(t,o))}catch(s){i.e(s)}finally{i.f()}return e.next=5,r.done;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteConnection",value:function(e){return this.db.delete(T.connection,z(e))}},{key:"updateConnection",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.db.put(T.connection,G(t,n)));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateConnections",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.updateMany(T.connection,n.map(z),n.map((function(e){return G(t,e)}))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"closeDB",value:function(){var e=Object(h.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.db.close();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearDB",value:function(){var e=Object(h.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.db.clear(T.graph),this.db.clear(T.connection),this.db.clear(T.node)]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateMany",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n,r){var i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.db.transaction(t,"readwrite"),e.next=3,Promise.all(r.map(function(){var e=Object(h.a)(l.a.mark((function e(t,r){var a,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n[r],e.next=3,i.store.get(a);case 3:if(o=e.sent){e.next=6;break}throw new Error;case 6:return e.abrupt("return",i.store.put(Object(p.a)(Object(p.a)({},o),t)));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:return e.next=5,i.done;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"updateIncrementalSingle",value:function(){var e=Object(h.a)(l.a.mark((function e(t,n,r){var i,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.db.transaction(t,"readwrite"),e.next=3,i.store.get(n);case 3:if(a=e.sent){e.next=6;break}throw new Error;case 6:return i.store.put(Object(p.a)(Object(p.a)({},a),r)),e.next=9,i.done;case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),e}(),ye=n(16),be=n(11),ve=(n(91),n(2)),me=n(325),Oe=(U=function(){function e(t,n,r,i){Object(D.a)(this,e),this.from=t,this.to=n,this.data=void 0,this.data=r(this,i)}return Object(F.a)(e,[{key:"graph",get:function(){return this.from.graph}},{key:"isSelected",get:function(){return this.from.graph.selectedConnection===this}},{key:"toJson",get:function(){return{from:this.from.key,to:this.to.key,data:this.data.toJson}}}]),e}(),Object(be.a)(U.prototype,"isSelected",[ve.h],Object.getOwnPropertyDescriptor(U.prototype,"isSelected"),U.prototype),Object(be.a)(U.prototype,"toJson",[ve.h],Object.getOwnPropertyDescriptor(U.prototype,"toJson"),U.prototype),U),ge=(J=function(){function e(t,n){Object(D.a)(this,e),this.graph=t,Object(ye.a)(this,"key",V,this),Object(ye.a)(this,"name",B,this),Object(ye.a)(this,"x",H,this),Object(ye.a)(this,"y",W,this),Object(ye.a)(this,"width",K,this),Object(ye.a)(this,"height",Y,this),Object(ye.a)(this,"data",Q,this),Object(ye.a)(this,"inputs",$,this),Object(ye.a)(this,"outputs",Z,this),Object(ye.a)(this,"move",X,this),Object(ye.a)(this,"setSize",q,this),Object(ye.a)(this,"setName",ee,this),this.key=n.key,this.name=n.name,this.x=n.x,this.y=n.y,this.data=n.dataBuilder(this,n.data)}return Object(F.a)(e,[{key:"addInput",value:function(e){this.inputs.push(e),e.from.outputs.push(e)}},{key:"addOutput",value:function(e){this.outputs.push(e),e.to.inputs.push(e)}},{key:"inputNodes",get:function(){return this.inputs.map((function(e){return e.from}))}},{key:"outputNodes",get:function(){return this.outputs.map((function(e){return e.to}))}},{key:"toJson",get:function(){return{key:this.key,name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,data:this.data.toJson}}}]),e}(),V=Object(be.a)(J.prototype,"key",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=Object(be.a)(J.prototype,"name",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=Object(be.a)(J.prototype,"x",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=Object(be.a)(J.prototype,"y",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=Object(be.a)(J.prototype,"width",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),Y=Object(be.a)(J.prototype,"height",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),Q=Object(be.a)(J.prototype,"data",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=Object(be.a)(J.prototype,"inputs",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ve.r.array()}}),Object(be.a)(J.prototype,"inputNodes",[ve.h],Object.getOwnPropertyDescriptor(J.prototype,"inputNodes"),J.prototype),Z=Object(be.a)(J.prototype,"outputs",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ve.r.array()}}),Object(be.a)(J.prototype,"outputNodes",[ve.h],Object.getOwnPropertyDescriptor(J.prototype,"outputNodes"),J.prototype),Object(be.a)(J.prototype,"addInput",[ve.g],Object.getOwnPropertyDescriptor(J.prototype,"addInput"),J.prototype),Object(be.a)(J.prototype,"addOutput",[ve.g],Object.getOwnPropertyDescriptor(J.prototype,"addOutput"),J.prototype),X=Object(be.a)(J.prototype,"move",[ve.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){e.x+=t,e.y+=n}}}),q=Object(be.a)(J.prototype,"setSize",[ve.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.width=t.width,e.height=t.height}}}),ee=Object(be.a)(J.prototype,"setName",[ve.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.name=t}}}),Object(be.a)(J.prototype,"toJson",[ve.h],Object.getOwnPropertyDescriptor(J.prototype,"toJson"),J.prototype),J),Ee=(te=function(){function e(t){var n,r,i,a,o,s=this;Object(D.a)(this,e),this.builders=void 0,this.globalData=void 0,this.db=void 0,this.key=void 0,Object(ye.a)(this,"resetStore",ne,this),Object(ye.a)(this,"nodes",re,this),Object(ye.a)(this,"selectedNode",ie,this),Object(ye.a)(this,"selectedConnection",ae,this),Object(ye.a)(this,"selectingInputFor",oe,this),Object(ye.a)(this,"selectNode",se,this),Object(ye.a)(this,"selectConnection",ce,this),Object(ye.a)(this,"addNode",ue,this),Object(ye.a)(this,"selectingInput",le,this),Object(ye.a)(this,"assignInput",pe,this),Object(ye.a)(this,"addConnection",he,this),Object(ye.a)(this,"_selectingInputKeyListener",de,this),this.db=t.db,this.builders=t.builders,this.globalData=t.builders.graphBuilder(this,null===(n=t.json)||void 0===n?void 0:n.graph.data),this.key=null!==(r=null===(i=t.json)||void 0===i?void 0:i.graph.key)&&void 0!==r?r:Object(me.a)();var c=null===(a=t.json)||void 0===a?void 0:a.nodes.reduce((function(e,n){var r=new ge(s,Object(p.a)(Object(p.a)({},n),{},{dataBuilder:t.builders.nodeBuilder}));return e[n.key]=r,e}),{});this.nodes=ve.r.map(null!==c&&void 0!==c?c:{}),null===(o=t.json)||void 0===o||o.connections.forEach((function(e){var t=s.nodes.get(e.from),n=s.nodes.get(e.to);void 0!==t&&void 0!==n&&s.addConnection(t,n,e.data)}))}return Object(F.a)(e,[{key:"removeNode",value:function(e){if(e===this.selectedNode&&(this.selectedNode=void 0),this.nodes.delete(e.key)){var t,n=Object(I.a)(e.inputs);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.from.outputs.remove(r)}}catch(s){n.e(s)}finally{n.f()}var i,a=Object(I.a)(e.outputs);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.to.inputs.remove(o)}}catch(s){a.e(s)}finally{a.f()}}}},{key:"removeConnection",value:function(e){e===this.selectedConnection&&(this.selectedConnection=void 0),e.from.outputs.remove(e),e.to.inputs.remove(e)}},{key:"saveModel",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(y.a)(this.nodes.entries()),e.next=3,this.db.clearDB();case 3:return e.next=5,Promise.all([this.db.updateGraph(this.toJson),this.db.addNodes(this.key,t.map((function(e){var t=Object(d.a)(e,2);t[0];return t[1].toJson}))),this.db.addConnections(this.key,t.flatMap((function(e){var t=Object(d.a)(e,2);t[0];return t[1].outputs})).map((function(e){return e.toJson})))]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"downloadModel",value:function(){var e=Object(y.a)(this.nodes.entries()),t={graph:this.toJson,nodes:e.map((function(e){var t=Object(d.a)(e,2);t[0];return t[1].toJson})),connections:e.flatMap((function(e){var t=Object(d.a)(e,2);t[0];return t[1].outputs})).map((function(e){return e.toJson}))};return console.log(t),function(e,t,n){var r=document.createElement("a"),i=new Blob([e],{type:n});r.href=URL.createObjectURL(i),r.download=t,r.click()}(JSON.stringify(t),"gemma-model.json","application/json"),t}},{key:"toJson",get:function(){return{data:this.globalData.toJson,key:this.key}}}]),e}(),ne=Object(be.a)(te.prototype,"resetStore",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),re=Object(be.a)(te.prototype,"nodes",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=Object(be.a)(te.prototype,"selectedNode",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=Object(be.a)(te.prototype,"selectedConnection",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oe=Object(be.a)(te.prototype,"selectingInputFor",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),se=Object(be.a)(te.prototype,"selectNode",[ve.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.selectedNode=t}}}),ce=Object(be.a)(te.prototype,"selectConnection",[ve.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.selectedConnection=t}}}),ue=Object(be.a)(te.prototype,"addNode",[ve.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n){if(e.globalData.canAddNode(t)){var r,i,a=new ge(e,{dataBuilder:e.builders.nodeBuilder,key:Object(me.a)(),name:t,x:null!==(r=null===n||void 0===n?void 0:n.x)&&void 0!==r?r:100,y:null!==(i=null===n||void 0===n?void 0:n.y)&&void 0!==i?i:100,data:{type:t}});return e.nodes.set(a.key,a),a}}}}),Object(be.a)(te.prototype,"removeNode",[ve.g],Object.getOwnPropertyDescriptor(te.prototype,"removeNode"),te.prototype),Object(be.a)(te.prototype,"removeConnection",[ve.g],Object.getOwnPropertyDescriptor(te.prototype,"removeConnection"),te.prototype),Object(be.a)(te.prototype,"toJson",[ve.h],Object.getOwnPropertyDescriptor(te.prototype,"toJson"),te.prototype),le=Object(be.a)(te.prototype,"selectingInput",[ve.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.selectingInputFor=t,window.addEventListener("keyup",e._selectingInputKeyListener)}}}),pe=Object(be.a)(te.prototype,"assignInput",[ve.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=new Oe(e.selectingInputFor,t,e.builders.connectionBuilder);return n.from.addOutput(n),e.selectingInputFor=void 0,e.selectedConnection=n,window.removeEventListener("keyup",e._selectingInputKeyListener),n}}}),he=Object(be.a)(te.prototype,"addConnection",[ve.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,n,r){var i=new Oe(t,n,e.builders.connectionBuilder,r);return i.from.addOutput(i),i}}}),de=Object(be.a)(te.prototype,"_selectingInputKeyListener",[ve.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){"Escape"===t.key&&(e.selectingInputFor=void 0,window.removeEventListener("keyup",e._selectingInputKeyListener))}}}),te);function xe(){var e=Object(v.a)(["\n  padding-bottom: 10px;\n  thead {\n    font-size: 1.1em;\n    font-weight: bolder;\n  }\n  tr td {\n    padding: 0;\n  }\n  tr td:first-child {\n    padding-right: 15px;\n    height: 32px;\n  }\n  tr td:last-child {\n    margin: auto auto;\n    padding-left: 10px;\n    text-align: center;\n    display: flex;\n    justify-content: center;\n    align-self: center;\n  }\n"]);return xe=function(){return e},e}var je=Object(b.a)((function(e){var t=e.children;return o.a.createElement(we,null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("td",null,"Property"),o.a.createElement("td",null,"Value"))),o.a.createElement("tbody",null,t))})),ke=Object(b.a)((function(e){var t=e.self,n=nn(),r=t.inputs.length>=t.data.nInputs,i=void 0!==n.selectingInputFor;return o.a.createElement(je,null,0!==t.data.nInputs&&o.a.createElement("tr",null,o.a.createElement("td",null,"Inputs"),o.a.createElement("td",null,t.inputs.map((function(e){return o.a.createElement("div",{onClick:function(){return n.selectConnection(e)},key:e.from.key,style:{padding:"5px"}},e.from.name)})),!r&&o.a.createElement("div",{onClick:function(){return n.selectingInput(t)},style:i?{background:"#eee"}:{cursor:"pointer"}},"Add Transition"))),Object.entries(t.data.spec).map((function(e){var n=Object(d.a)(e,2),r=n[0],i=n[1];return o.a.createElement("tr",{key:r},o.a.createElement("td",null,r),o.a.createElement("td",null,o.a.createElement(i.plotField,{name:r,model:t.data})))})))})),we=g.a.table(xe()),Ne=n(321),Ae=n(102),Ie=n(324),Re=(n(214),Object(b.a)((function(){var e,t=nn();if(null!=t.selectedNode){var n=t.selectedNode,r=t.selectedConnection;e=o.a.createElement("div",{style:{overflow:"auto",maxHeight:"100%",maxWidth:"100%",justifyContent:"space-around",backgroundColor:"#fafafa",display:"flex"},key:t.selectedNode.key,className:"row"},o.a.createElement("div",{className:"properties-view"},o.a.createElement("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"}},o.a.createElement(Ie.a,{type:"text",value:n.name,onChange:function(e){return n.setName(e.target.value)},style:{width:"150px"}}),o.a.createElement(Ne.a,{onClick:function(e){return t.removeNode(n)}},o.a.createElement(Ae.a,{icon:"trash-alt",color:"#000"}))),o.a.createElement(ke,{self:t.selectedNode})),o.a.createElement("div",{className:"properties-view"},void 0!==r&&o.a.createElement("div",{className:"col"},o.a.createElement("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"}},o.a.createElement("div",null,"".concat(r.from.name," -> ").concat(r.to.name)),o.a.createElement(Ne.a,{onClick:function(e){return t.removeConnection(r)}},o.a.createElement(Ae.a,{icon:"trash-alt",color:"#000"}))),o.a.createElement(r.data.ConnectionView,null))),o.a.createElement("div",{style:{minWidth:"270px"},className:"properties-view"},o.a.createElement(t.globalData.View,null)))}else e=o.a.createElement("div",{style:{width:"150px"},className:"row"},o.a.createElement("div",{style:{width:"150px"},className:"center"},"Not selected"));return o.a.createElement(R.a,{minHeight:200,defaultSize:{height:280,width:"auto"},style:{position:"relative",background:"white",boxShadow:"0 1px 4px 1px #eee",border:"1px solid #eee"},enable:S({top:!0})},e)}))),Ce=n(85),Se=n(24),Le=n(23),Te=n(322),_e=n(326),De=n(323),Fe=n(34);function Pe(){var e=Object(v.a)(["\n  min-height: 38px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]);return Pe=function(){return e},e}var Me,ze,Ge,Ue,Je,Ve=g.a.div(Pe()),Be=function e(t){var n=this;if(Object(D.a)(this,e),this.choices=void 0,this.default=void 0,this.isObservableMap=function(){return"function"===typeof n.choices.keys&&"number"===typeof n.choices.size&&Symbol.toStringTag in n.choices},this.mobxProp=function(){return void 0!==n.default?Fe.a.optional(Fe.a.string,n.default):Fe.a.string},this.plotField=Object(b.a)((function(e){var t,r=e.name,i=e.model;return t=n.isObservableMap()?Array.from(n.choices.keys()):Object.keys(n.choices),o.a.createElement(He,{value:i[r],setValue:function(e){return i[r]=e},keys:t})})),this.choices=t.choices,this.default=t.default,this.isObservableMap()&&null===this.choices.get(this.default))throw Error("")},He=function(e){var t=e.keys,n=e.value,r=e.setValue;return t.length>3?o.a.createElement(De.a,{value:n,onChange:function(e){r(e.target.value)},autoWidth:!0},t.map((function(e){return o.a.createElement(_e.a,{key:e,value:e},e)}))):o.a.createElement(Ve,null,o.a.createElement(Te.a,{size:"small",color:"primary","aria-label":"outlined primary button group"},t.map((function(e){var t=e===n?{background:"#3f51b5",color:"white"}:{};return o.a.createElement(f.a,{key:e,onClick:function(){r(e)},style:t},e)}))))},We=(n(328),function e(t){var n=this;if(Object(D.a)(this,e),this.default=void 0,this.maxLength=void 0,this.minLength=void 0,this.mobxProp=function(){return void 0!==n.default?Fe.a.optional(Fe.a.string,n.default):Fe.a.string},this.plotField=Object(b.a)((function(e){var t=e.name,r=e.model,i=o.a.useState(r[t]),a=Object(d.a)(i,2),s=a[0],c=a[1],u=r.errors;return o.a.createElement(Ie.a,{key:t,value:s,inputProps:{style:{textAlign:"center"}},onChange:function(e){var i=e.target.value;c(i),void 0!==n.maxLength&&i.length>n.maxLength?u.set(t,"Max length exceded."):void 0!==n.minLength&&i.length<n.minLength?u.set(t,"Min length exceded."):(u.delete(t),r[t]=i)},error:void 0!==u.get(t),fullWidth:!0,style:{width:"140px"}})})),this.default=t.default,this.maxLength=t.maxLength,this.minLength=t.minLength,"string"===typeof this.default){if(void 0!==this.minLength&&this.default.length<this.minLength)throw Error("");if(void 0!==this.maxLength&&this.default.length>this.maxLength)throw Error("")}});!function(e){e.ENCLOSING="ENCLOSING",e.INITIAL="INITIAL",e.MACRO="MACRO",e.SIMPLE="SIMPLE"}(Ue||(Ue={})),function(e){e.F="F",e.D="D",e.A="A"}(Je||(Je={}));var Ke=(Me=function(){function e(t,n){var r,i,a,s=this;Object(D.a)(this,e),this.node=t,this.type=void 0,this.nInputs=Number.POSITIVE_INFINITY,this.errors=ve.r.map(),Object(ye.a)(this,"description",ze,this),Object(ye.a)(this,"family",Ge,this),this.spec={family:new Be({default:Je.F,choices:(a=Object.values(Je),a.reduce((function(e,t){return e[t.toString()]=t,e}),{}))}),description:new We({default:""})},this.View=Object(b.a)((function(){var e={},t={padding:"12px"};switch(s.type){case Ue.ENCLOSING:return e={padding:"0 0",display:"flex"},o.a.createElement("div",{style:e},o.a.createElement("span",null),o.a.createElement("div",{style:Object(p.a)({},t)},s.node.name),o.a.createElement("span",null));case Ue.MACRO:e={padding:"5px 0"},t={border:"1.5px solid",borderRight:"0",borderLeft:"0",padding:"5px 12px"};break;case Ue.INITIAL:e={padding:"5px"},t={border:"1.5px solid",padding:"7px"}}return o.a.createElement("div",{style:e},o.a.createElement("div",{style:t},s.node.name))})),this.description=null!==(r=null===n||void 0===n?void 0:n.description)&&void 0!==r?r:"",this.family=null!==(i=null===n||void 0===n?void 0:n.family)&&void 0!==i?i:Je.F}return Object(F.a)(e,[{key:"isValidInput",value:function(e){return this.node.inputNodes.every((function(t){return t.data!==e.data}))}},{key:"name",get:function(){return this.node.name}},{key:"automationSystem",get:function(){return this.node.graph.globalData}},{key:"_transitions",get:function(){return this.node.outputs.map((function(e){return e.data})).sort((function(e,t){return e.priority-t.priority}))}},{key:"innerTransitionsLength",get:function(){return this._transitions.length}},{key:"transitions",get:function(){return this.family===Je.F?this.automationSystem.workingFamilyTransitions.concat(this._transitions):this._transitions}},{key:"id",get:function(){return this.automationSystem.steps.indexOf(this)+1}},{key:"toJson",get:function(){return{family:this.family,description:this.description,type:this.type}}}]),e}(),Object(be.a)(Me.prototype,"name",[ve.h],Object.getOwnPropertyDescriptor(Me.prototype,"name"),Me.prototype),ze=Object(be.a)(Me.prototype,"description",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ge=Object(be.a)(Me.prototype,"family",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(be.a)(Me.prototype,"_transitions",[ve.h],Object.getOwnPropertyDescriptor(Me.prototype,"_transitions"),Me.prototype),Object(be.a)(Me.prototype,"innerTransitionsLength",[ve.h],Object.getOwnPropertyDescriptor(Me.prototype,"innerTransitionsLength"),Me.prototype),Object(be.a)(Me.prototype,"transitions",[ve.h],Object.getOwnPropertyDescriptor(Me.prototype,"transitions"),Me.prototype),Object(be.a)(Me.prototype,"id",[ve.h],Object.getOwnPropertyDescriptor(Me.prototype,"id"),Me.prototype),Object(be.a)(Me.prototype,"toJson",[ve.h],Object.getOwnPropertyDescriptor(Me.prototype,"toJson"),Me.prototype),Me),Ye=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(){var e;Object(D.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).type=Ue.SIMPLE,e}return n}(Ke),Qe=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(){var e;Object(D.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).type=Ue.INITIAL,e}return n}(Ke),$e=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(){var e;Object(D.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).type=Ue.ENCLOSING,e}return n}(Ke),Ze=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(){var e;Object(D.a)(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).type=Ue.MACRO,e}return n}(Ke),Xe=function e(){Object(D.a)(this,e)};Xe.textOrEmpty=function(e,t){return e?t:""};var qe=function(e,t){var n=t.isNested;return"".concat(e.map((function(e,t){return"\n".concat(0===t?"IF":"ELSIF"," ").concat(e.condition.expression," THEN\n  State:=").concat(e.to.id,";  ").concat(n?"\n  Entry:=TRUE;":"")})).join("\n")).concat(0===e.length?"":"\nEND_IF")},et=function(e){return"IF Entry THEN\n  ".concat(e.name,"(Initialization:=ENTRY);\n  Entry:=FALSE;\nEND_IF\n").concat(e.name,"(Initialization:=ENTRY);")},tt=function(e){var t;return"\n// Variable declaration\nVAR\n".concat(e.steps.filter((function(e){return e.type===Ue.ENCLOSING||e.type===Ue.MACRO})).map((function(e){return"  ".concat(e.name,":").concat(e.name,"_FB;")})).join("\n"),"\n\n  State:UINT:=").concat(null===(t=e.initialStep)||void 0===t?void 0:t.id,";\n  Entry:BOOL:=TRUE;\nEND_VAR\n\n// Program behavior\nCASE State OF\n  ").concat(e.steps.map((function(e){return"\n  ".concat(e.id,": //State ").concat(e.name,"\n    ").concat(function(){switch(e.type){case Ue.ENCLOSING:return function(e){return"".concat(et(e),"\n\n").concat(qe(e.transitions,{isNested:!0}))}(e);case Ue.INITIAL:case Ue.SIMPLE:return function(e){return qe(e.transitions,{isNested:!1})}(e);case Ue.MACRO:return function(e){var t=e.transitions;return"\n".concat(et(e),"\n\n").concat(t.map((function(n,r){return"".concat(0===r?"IF":"ELSIF"," ").concat(n.condition.expression).concat(t.length-e.innerTransitionsLength<=r?" AND ".concat(e.name,".Complete"):""," THEN\n  State:=").concat(n.to.id,";\n  Entry:=TRUE;")})).join("\n")).concat(Xe.textOrEmpty(0!==t.length,"\nEND_IF"))}(e)}}().replace(/\n/g,"\n    "),"\n  ")})).join("\n"),"\nEND_CASE\n")},nt=n(144),rt=n(84),it=n(79),at=n(50),ot=n(97),st=n(45),ct=n(39),ut=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e))._interp=new ot.LexerATNSimulator(n._ATN,Object(rt.a)(r)),r}return Object(F.a)(n,[{key:"vocabulary",get:function(){return n.VOCABULARY}}]),Object(F.a)(n,[{key:"grammarFileName",get:function(){return"SimpleBoolean.g4"}},{key:"ruleNames",get:function(){return n.ruleNames}},{key:"serializedATN",get:function(){return n._serializedATN}},{key:"channelNames",get:function(){return n.channelNames}},{key:"modeNames",get:function(){return n.modeNames}}],[{key:"_ATN",get:function(){return n.__ATN||(n.__ATN=(new it.ATNDeserializer).deserialize(ct.toCharArray(n._serializedATN))),n.__ATN}}]),n}(at.Lexer);ut.AND=1,ut.OR=2,ut.NOT=3,ut.TRUE=4,ut.FALSE=5,ut.GT=6,ut.GE=7,ut.LT=8,ut.LE=9,ut.EQ=10,ut.LPAREN=11,ut.RPAREN=12,ut.DECIMAL=13,ut.IDENTIFIER=14,ut.WS=15,ut.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"],ut.modeNames=["DEFAULT_MODE"],ut.ruleNames=["AND","OR","NOT","TRUE","FALSE","GT","GE","LT","LE","EQ","LPAREN","RPAREN","DECIMAL","IDENTIFIER","WS"],ut._LITERAL_NAMES=[void 0,"'AND'","'OR'","'NOT'","'TRUE'","'FALSE'","'>'","'>='","'<'","'<='","'='","'('","')'"],ut._SYMBOLIC_NAMES=[void 0,"AND","OR","NOT","TRUE","FALSE","GT","GE","LT","LE","EQ","LPAREN","RPAREN","DECIMAL","IDENTIFIER","WS"],ut.VOCABULARY=new st.VocabularyImpl(ut._LITERAL_NAMES,ut._SYMBOLIC_NAMES,[]),ut._serializedATN='\x03\uc91d\ucaba\u058d\uafba\u4f53\u0607\uea8b\uc241\x02\x11e\b\x01\x04\x02\t\x02\x04\x03\t\x03\x04\x04\t\x04\x04\x05\t\x05\x04\x06\t\x06\x04\x07\t\x07\x04\b\t\b\x04\t\t\t\x04\n\t\n\x04\v\t\v\x04\f\t\f\x04\r\t\r\x04\x0e\t\x0e\x04\x0f\t\x0f\x04\x10\t\x10\x03\x02\x03\x02\x03\x02\x03\x02\x03\x03\x03\x03\x03\x03\x03\x04\x03\x04\x03\x04\x03\x04\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x03\x06\x03\x06\x03\x06\x03\x06\x03\x06\x03\x06\x03\x07\x03\x07\x03\b\x03\b\x03\b\x03\t\x03\t\x03\n\x03\n\x03\n\x03\v\x03\v\x03\f\x03\f\x03\r\x03\r\x03\x0e\x05\x0eI\n\x0e\x03\x0e\x06\x0eL\n\x0e\r\x0e\x0e\x0eM\x03\x0e\x03\x0e\x06\x0eR\n\x0e\r\x0e\x0e\x0eS\x05\x0eV\n\x0e\x03\x0f\x03\x0f\x07\x0fZ\n\x0f\f\x0f\x0e\x0f]\v\x0f\x03\x10\x06\x10`\n\x10\r\x10\x0e\x10a\x03\x10\x03\x10\x02\x02\x02\x11\x03\x02\x03\x05\x02\x04\x07\x02\x05\t\x02\x06\v\x02\x07\r\x02\b\x0f\x02\t\x11\x02\n\x13\x02\v\x15\x02\f\x17\x02\r\x19\x02\x0e\x1b\x02\x0f\x1d\x02\x10\x1f\x02\x11\x03\x02\x06\x03\x022;\x05\x02C\\aac|\x06\x022;C\\aac|\x05\x02\v\f\x0e\x0f""\x02j\x02\x03\x03\x02\x02\x02\x02\x05\x03\x02\x02\x02\x02\x07\x03\x02\x02\x02\x02\t\x03\x02\x02\x02\x02\v\x03\x02\x02\x02\x02\r\x03\x02\x02\x02\x02\x0f\x03\x02\x02\x02\x02\x11\x03\x02\x02\x02\x02\x13\x03\x02\x02\x02\x02\x15\x03\x02\x02\x02\x02\x17\x03\x02\x02\x02\x02\x19\x03\x02\x02\x02\x02\x1b\x03\x02\x02\x02\x02\x1d\x03\x02\x02\x02\x02\x1f\x03\x02\x02\x02\x03!\x03\x02\x02\x02\x05%\x03\x02\x02\x02\x07(\x03\x02\x02\x02\t,\x03\x02\x02\x02\v1\x03\x02\x02\x02\r7\x03\x02\x02\x02\x0f9\x03\x02\x02\x02\x11<\x03\x02\x02\x02\x13>\x03\x02\x02\x02\x15A\x03\x02\x02\x02\x17C\x03\x02\x02\x02\x19E\x03\x02\x02\x02\x1bH\x03\x02\x02\x02\x1dW\x03\x02\x02\x02\x1f_\x03\x02\x02\x02!"\x07C\x02\x02"#\x07P\x02\x02#$\x07F\x02\x02$\x04\x03\x02\x02\x02%&\x07Q\x02\x02&\'\x07T\x02\x02\'\x06\x03\x02\x02\x02()\x07P\x02\x02)*\x07Q\x02\x02*+\x07V\x02\x02+\b\x03\x02\x02\x02,-\x07V\x02\x02-.\x07T\x02\x02./\x07W\x02\x02/0\x07G\x02\x020\n\x03\x02\x02\x0212\x07H\x02\x0223\x07C\x02\x0234\x07N\x02\x0245\x07U\x02\x0256\x07G\x02\x026\f\x03\x02\x02\x0278\x07@\x02\x028\x0e\x03\x02\x02\x029:\x07@\x02\x02:;\x07?\x02\x02;\x10\x03\x02\x02\x02<=\x07>\x02\x02=\x12\x03\x02\x02\x02>?\x07>\x02\x02?@\x07?\x02\x02@\x14\x03\x02\x02\x02AB\x07?\x02\x02B\x16\x03\x02\x02\x02CD\x07*\x02\x02D\x18\x03\x02\x02\x02EF\x07+\x02\x02F\x1a\x03\x02\x02\x02GI\x07/\x02\x02HG\x03\x02\x02\x02HI\x03\x02\x02\x02IK\x03\x02\x02\x02JL\t\x02\x02\x02KJ\x03\x02\x02\x02LM\x03\x02\x02\x02MK\x03\x02\x02\x02MN\x03\x02\x02\x02NU\x03\x02\x02\x02OQ\x070\x02\x02PR\t\x02\x02\x02QP\x03\x02\x02\x02RS\x03\x02\x02\x02SQ\x03\x02\x02\x02ST\x03\x02\x02\x02TV\x03\x02\x02\x02UO\x03\x02\x02\x02UV\x03\x02\x02\x02V\x1c\x03\x02\x02\x02W[\t\x03\x02\x02XZ\t\x04\x02\x02YX\x03\x02\x02\x02Z]\x03\x02\x02\x02[Y\x03\x02\x02\x02[\\\x03\x02\x02\x02\\\x1e\x03\x02\x02\x02][\x03\x02\x02\x02^`\t\x05\x02\x02_^\x03\x02\x02\x02`a\x03\x02\x02\x02a_\x03\x02\x02\x02ab\x03\x02\x02\x02bc\x03\x02\x02\x02cd\b\x10\x02\x02d \x03\x02\x02\x02\t\x02HMSU[a\x03\b\x02\x02',ut.__ATN=void 0;var lt=n(105),pt=n(47),ht=n(98),dt=n(77),ft=n(32),yt=n(78),bt=n(36),vt=n(25),mt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e))._interp=new yt.ParserATNSimulator(n._ATN,Object(rt.a)(r)),r}return Object(F.a)(n,[{key:"vocabulary",get:function(){return n.VOCABULARY}},{key:"grammarFileName",get:function(){return"SimpleBoolean.g4"}},{key:"ruleNames",get:function(){return n.ruleNames}},{key:"serializedATN",get:function(){return n._serializedATN}}]),Object(F.a)(n,[{key:"parse",value:function(){var e=new Ct(this._ctx,this.state);this.enterRule(e,0,n.RULE_parse);try{this.enterOuterAlt(e,1),this.state=12,this.expression(),this.state=13,this.match(n.EOF)}catch(t){if(!(t instanceof bt.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}},{key:"expression",value:function(){var e=new St(this._ctx,this.state);this.enterRule(e,2,n.RULE_expression);try{switch(this.state=22,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,0,this._ctx)){case 1:e=new Lt(e),this.enterOuterAlt(e,1),this.state=15,this.match(n.NOT),this.state=16,this.expression();break;case 2:e=new Tt(e),this.enterOuterAlt(e,2),this.state=17,e._left=this.expressionAnd(),this.state=18,this.match(n.OR),this.state=19,e._right=this.expression();break;case 3:e=new _t(e),this.enterOuterAlt(e,3),this.state=21,this.expressionAnd()}}catch(t){if(!(t instanceof bt.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}},{key:"expressionAnd",value:function(){var e=new Dt(this._ctx,this.state);this.enterRule(e,4,n.RULE_expressionAnd);try{switch(this.state=29,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,1,this._ctx)){case 1:e=new Ft(e),this.enterOuterAlt(e,1),this.state=24,e._left=this.expressionSimple(),this.state=25,this.match(n.AND),this.state=26,e._right=this.expressionAnd();break;case 2:e=new Pt(e),this.enterOuterAlt(e,2),this.state=28,this.expressionSimple()}}catch(t){if(!(t instanceof bt.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}},{key:"expressionSimple",value:function(){var e=new Mt(this._ctx,this.state);this.enterRule(e,6,n.RULE_expressionSimple);try{switch(this.state=40,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,2,this._ctx)){case 1:e=new zt(e),this.enterOuterAlt(e,1),this.state=31,e._left=this.numExpression(),this.state=32,e._op=this.comparator(),this.state=33,e._right=this.numExpression();break;case 2:e=new Gt(e),this.enterOuterAlt(e,2),this.state=35,this.match(n.IDENTIFIER);break;case 3:e=new Ut(e),this.enterOuterAlt(e,3),this.state=36,this.match(n.LPAREN),this.state=37,this.expression(),this.state=38,this.match(n.RPAREN)}}catch(t){if(!(t instanceof bt.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}},{key:"numExpression",value:function(){var e=new Jt(this._ctx,this.state);this.enterRule(e,8,n.RULE_numExpression);try{switch(this.state=44,this._errHandler.sync(this),this._input.LA(1)){case n.IDENTIFIER:e=new Vt(e),this.enterOuterAlt(e,1),this.state=42,this.match(n.IDENTIFIER);break;case n.DECIMAL:e=new Bt(e),this.enterOuterAlt(e,2),this.state=43,this.match(n.DECIMAL);break;default:throw new ht.NoViableAltException(this)}}catch(t){if(!(t instanceof bt.RecognitionException))throw t;e.exception=t,this._errHandler.reportError(this,t),this._errHandler.recover(this,t)}finally{this.exitRule()}return e}},{key:"comparator",value:function(){var e,t=new Ht(this._ctx,this.state);this.enterRule(t,10,n.RULE_comparator);try{this.enterOuterAlt(t,1),this.state=46,0!==(-32&(e=this._input.LA(1)))||0===(1<<e&(1<<n.GT|1<<n.GE|1<<n.LT|1<<n.LE|1<<n.EQ))?this._errHandler.recoverInline(this):(this._input.LA(1)===vt.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume())}catch(r){if(!(r instanceof bt.RecognitionException))throw r;t.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r)}finally{this.exitRule()}return t}}],[{key:"_ATN",get:function(){return n.__ATN||(n.__ATN=(new it.ATNDeserializer).deserialize(ct.toCharArray(n._serializedATN))),n.__ATN}}]),n}(dt.Parser);mt.AND=1,mt.OR=2,mt.NOT=3,mt.TRUE=4,mt.FALSE=5,mt.GT=6,mt.GE=7,mt.LT=8,mt.LE=9,mt.EQ=10,mt.LPAREN=11,mt.RPAREN=12,mt.DECIMAL=13,mt.IDENTIFIER=14,mt.WS=15,mt.RULE_parse=0,mt.RULE_expression=1,mt.RULE_expressionAnd=2,mt.RULE_expressionSimple=3,mt.RULE_numExpression=4,mt.RULE_comparator=5,mt.ruleNames=["parse","expression","expressionAnd","expressionSimple","numExpression","comparator"],mt._LITERAL_NAMES=[void 0,"'AND'","'OR'","'NOT'","'TRUE'","'FALSE'","'>'","'>='","'<'","'<='","'='","'('","')'"],mt._SYMBOLIC_NAMES=[void 0,"AND","OR","NOT","TRUE","FALSE","GT","GE","LT","LE","EQ","LPAREN","RPAREN","DECIMAL","IDENTIFIER","WS"],mt.VOCABULARY=new st.VocabularyImpl(mt._LITERAL_NAMES,mt._SYMBOLIC_NAMES,[]),mt._serializedATN="\x03\uc91d\ucaba\u058d\uafba\u4f53\u0607\uea8b\uc241\x03\x113\x04\x02\t\x02\x04\x03\t\x03\x04\x04\t\x04\x04\x05\t\x05\x04\x06\t\x06\x04\x07\t\x07\x03\x02\x03\x02\x03\x02\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x03\x05\x03\x19\n\x03\x03\x04\x03\x04\x03\x04\x03\x04\x03\x04\x05\x04 \n\x04\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x03\x05\x05\x05+\n\x05\x03\x06\x03\x06\x05\x06/\n\x06\x03\x07\x03\x07\x03\x07\x02\x02\x02\b\x02\x02\x04\x02\x06\x02\b\x02\n\x02\f\x02\x02\x03\x03\x02\b\f\x022\x02\x0e\x03\x02\x02\x02\x04\x18\x03\x02\x02\x02\x06\x1f\x03\x02\x02\x02\b*\x03\x02\x02\x02\n.\x03\x02\x02\x02\f0\x03\x02\x02\x02\x0e\x0f\x05\x04\x03\x02\x0f\x10\x07\x02\x02\x03\x10\x03\x03\x02\x02\x02\x11\x12\x07\x05\x02\x02\x12\x19\x05\x04\x03\x02\x13\x14\x05\x06\x04\x02\x14\x15\x07\x04\x02\x02\x15\x16\x05\x04\x03\x02\x16\x19\x03\x02\x02\x02\x17\x19\x05\x06\x04\x02\x18\x11\x03\x02\x02\x02\x18\x13\x03\x02\x02\x02\x18\x17\x03\x02\x02\x02\x19\x05\x03\x02\x02\x02\x1a\x1b\x05\b\x05\x02\x1b\x1c\x07\x03\x02\x02\x1c\x1d\x05\x06\x04\x02\x1d \x03\x02\x02\x02\x1e \x05\b\x05\x02\x1f\x1a\x03\x02\x02\x02\x1f\x1e\x03\x02\x02\x02 \x07\x03\x02\x02\x02!\"\x05\n\x06\x02\"#\x05\f\x07\x02#$\x05\n\x06\x02$+\x03\x02\x02\x02%+\x07\x10\x02\x02&'\x07\r\x02\x02'(\x05\x04\x03\x02()\x07\x0e\x02\x02)+\x03\x02\x02\x02*!\x03\x02\x02\x02*%\x03\x02\x02\x02*&\x03\x02\x02\x02+\t\x03\x02\x02\x02,/\x07\x10\x02\x02-/\x07\x0f\x02\x02.,\x03\x02\x02\x02.-\x03\x02\x02\x02/\v\x03\x02\x02\x0201\t\x02\x02\x021\r\x03\x02\x02\x02\x06\x18\x1f*.",mt.__ATN=void 0;var Ot,gt,Et,xt,jt,kt,wt,Nt,At,It,Rt,Ct=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e,r){return Object(D.a)(this,n),t.call(this,e,r)}return Object(F.a)(n,[{key:"expression",value:function(){return this.getRuleContext(0,St)}},{key:"EOF",value:function(){return this.getToken(mt.EOF,0)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterParse&&e.enterParse(this)}},{key:"exitRule",value:function(e){e.exitParse&&e.exitParse(this)}},{key:"accept",value:function(e){return e.visitParse?e.visitParse(this):e.visitChildren(this)}},{key:"ruleIndex",get:function(){return mt.RULE_parse}}]),n}(ft.ParserRuleContext),St=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e,r){return Object(D.a)(this,n),t.call(this,e,r)}return Object(F.a)(n,[{key:"copyFrom",value:function(e){Object(lt.a)(Object(pt.a)(n.prototype),"copyFrom",this).call(this,e)}},{key:"ruleIndex",get:function(){return mt.RULE_expression}}]),n}(ft.ParserRuleContext),Lt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e.parent,e.invokingState)).copyFrom(e),r}return Object(F.a)(n,[{key:"NOT",value:function(){return this.getToken(mt.NOT,0)}},{key:"expression",value:function(){return this.getRuleContext(0,St)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterNotExpression&&e.enterNotExpression(this)}},{key:"exitRule",value:function(e){e.exitNotExpression&&e.exitNotExpression(this)}},{key:"accept",value:function(e){return e.visitNotExpression?e.visitNotExpression(this):e.visitChildren(this)}}]),n}(St),Tt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e.parent,e.invokingState))._left=void 0,r._right=void 0,r.copyFrom(e),r}return Object(F.a)(n,[{key:"OR",value:function(){return this.getToken(mt.OR,0)}},{key:"expressionAnd",value:function(){return this.getRuleContext(0,Dt)}},{key:"expression",value:function(){return this.getRuleContext(0,St)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterOrExpression&&e.enterOrExpression(this)}},{key:"exitRule",value:function(e){e.exitOrExpression&&e.exitOrExpression(this)}},{key:"accept",value:function(e){return e.visitOrExpression?e.visitOrExpression(this):e.visitChildren(this)}}]),n}(St),_t=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e.parent,e.invokingState)).copyFrom(e),r}return Object(F.a)(n,[{key:"expressionAnd",value:function(){return this.getRuleContext(0,Dt)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterAndParentExpression&&e.enterAndParentExpression(this)}},{key:"exitRule",value:function(e){e.exitAndParentExpression&&e.exitAndParentExpression(this)}},{key:"accept",value:function(e){return e.visitAndParentExpression?e.visitAndParentExpression(this):e.visitChildren(this)}}]),n}(St),Dt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e,r){return Object(D.a)(this,n),t.call(this,e,r)}return Object(F.a)(n,[{key:"copyFrom",value:function(e){Object(lt.a)(Object(pt.a)(n.prototype),"copyFrom",this).call(this,e)}},{key:"ruleIndex",get:function(){return mt.RULE_expressionAnd}}]),n}(ft.ParserRuleContext),Ft=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e.parent,e.invokingState))._left=void 0,r._right=void 0,r.copyFrom(e),r}return Object(F.a)(n,[{key:"AND",value:function(){return this.getToken(mt.AND,0)}},{key:"expressionSimple",value:function(){return this.getRuleContext(0,Mt)}},{key:"expressionAnd",value:function(){return this.getRuleContext(0,Dt)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterAndExpression&&e.enterAndExpression(this)}},{key:"exitRule",value:function(e){e.exitAndExpression&&e.exitAndExpression(this)}},{key:"accept",value:function(e){return e.visitAndExpression?e.visitAndExpression(this):e.visitChildren(this)}}]),n}(Dt),Pt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e.parent,e.invokingState)).copyFrom(e),r}return Object(F.a)(n,[{key:"expressionSimple",value:function(){return this.getRuleContext(0,Mt)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterSimpleExpression&&e.enterSimpleExpression(this)}},{key:"exitRule",value:function(e){e.exitSimpleExpression&&e.exitSimpleExpression(this)}},{key:"accept",value:function(e){return e.visitSimpleExpression?e.visitSimpleExpression(this):e.visitChildren(this)}}]),n}(Dt),Mt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e,r){return Object(D.a)(this,n),t.call(this,e,r)}return Object(F.a)(n,[{key:"copyFrom",value:function(e){Object(lt.a)(Object(pt.a)(n.prototype),"copyFrom",this).call(this,e)}},{key:"ruleIndex",get:function(){return mt.RULE_expressionSimple}}]),n}(ft.ParserRuleContext),zt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e.parent,e.invokingState))._left=void 0,r._op=void 0,r._right=void 0,r.copyFrom(e),r}return Object(F.a)(n,[{key:"numExpression",value:function(e){return void 0===e?this.getRuleContexts(Jt):this.getRuleContext(e,Jt)}},{key:"comparator",value:function(){return this.getRuleContext(0,Ht)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterComparatorExpression&&e.enterComparatorExpression(this)}},{key:"exitRule",value:function(e){e.exitComparatorExpression&&e.exitComparatorExpression(this)}},{key:"accept",value:function(e){return e.visitComparatorExpression?e.visitComparatorExpression(this):e.visitChildren(this)}}]),n}(Mt),Gt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e.parent,e.invokingState)).copyFrom(e),r}return Object(F.a)(n,[{key:"IDENTIFIER",value:function(){return this.getToken(mt.IDENTIFIER,0)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterIdentifierExpression&&e.enterIdentifierExpression(this)}},{key:"exitRule",value:function(e){e.exitIdentifierExpression&&e.exitIdentifierExpression(this)}},{key:"accept",value:function(e){return e.visitIdentifierExpression?e.visitIdentifierExpression(this):e.visitChildren(this)}}]),n}(Mt),Ut=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e.parent,e.invokingState)).copyFrom(e),r}return Object(F.a)(n,[{key:"LPAREN",value:function(){return this.getToken(mt.LPAREN,0)}},{key:"expression",value:function(){return this.getRuleContext(0,St)}},{key:"RPAREN",value:function(){return this.getToken(mt.RPAREN,0)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterParenExpression&&e.enterParenExpression(this)}},{key:"exitRule",value:function(e){e.exitParenExpression&&e.exitParenExpression(this)}},{key:"accept",value:function(e){return e.visitParenExpression?e.visitParenExpression(this):e.visitChildren(this)}}]),n}(Mt),Jt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e,r){return Object(D.a)(this,n),t.call(this,e,r)}return Object(F.a)(n,[{key:"copyFrom",value:function(e){Object(lt.a)(Object(pt.a)(n.prototype),"copyFrom",this).call(this,e)}},{key:"ruleIndex",get:function(){return mt.RULE_numExpression}}]),n}(ft.ParserRuleContext),Vt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e.parent,e.invokingState)).copyFrom(e),r}return Object(F.a)(n,[{key:"IDENTIFIER",value:function(){return this.getToken(mt.IDENTIFIER,0)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterIdentifierNumExpression&&e.enterIdentifierNumExpression(this)}},{key:"exitRule",value:function(e){e.exitIdentifierNumExpression&&e.exitIdentifierNumExpression(this)}},{key:"accept",value:function(e){return e.visitIdentifierNumExpression?e.visitIdentifierNumExpression(this):e.visitChildren(this)}}]),n}(Jt),Bt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this,e.parent,e.invokingState)).copyFrom(e),r}return Object(F.a)(n,[{key:"DECIMAL",value:function(){return this.getToken(mt.DECIMAL,0)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterDecimalExpression&&e.enterDecimalExpression(this)}},{key:"exitRule",value:function(e){e.exitDecimalExpression&&e.exitDecimalExpression(this)}},{key:"accept",value:function(e){return e.visitDecimalExpression?e.visitDecimalExpression(this):e.visitChildren(this)}}]),n}(Jt),Ht=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e,r){return Object(D.a)(this,n),t.call(this,e,r)}return Object(F.a)(n,[{key:"GT",value:function(){return this.tryGetToken(mt.GT,0)}},{key:"GE",value:function(){return this.tryGetToken(mt.GE,0)}},{key:"LT",value:function(){return this.tryGetToken(mt.LT,0)}},{key:"LE",value:function(){return this.tryGetToken(mt.LE,0)}},{key:"EQ",value:function(){return this.tryGetToken(mt.EQ,0)}}]),Object(F.a)(n,[{key:"enterRule",value:function(e){e.enterComparator&&e.enterComparator(this)}},{key:"exitRule",value:function(e){e.exitComparator&&e.exitComparator(this)}},{key:"accept",value:function(e){return e.visitComparator?e.visitComparator(this):e.visitChildren(this)}},{key:"ruleIndex",get:function(){return mt.RULE_comparator}}]),n}(ft.ParserRuleContext),Wt=function(e){Object(Se.a)(n,e);var t=Object(Le.a)(n);function n(e){var r;return Object(D.a)(this,n),(r=t.call(this)).signals=e,r.isInvalid=!1,r}return Object(F.a)(n,[{key:"defaultResult",value:function(){return[]}},{key:"aggregateResult",value:function(e,t){return e.concat(t)}},{key:"visitErrorNode",value:function(e){return this.isInvalid?[]:(this.isInvalid=!0,["Invalid boolean expression"])}},{key:"visitIdentifierExpression",value:function(e){return this.signals.boolSignals.includes(e.text)?[]:["'".concat(e.text,"' is not a defined boolean signal")]}},{key:"visitIdentifierNumExpression",value:function(e){return this.signals.numSignals.includes(e.text)?[]:["'".concat(e.text,"' is not a defined numeric signal")]}},{key:"visitExpression",value:function(e){return console.log("Dddddddddddddddddddddd"),void 0===e.exception||this.isInvalid?[]:(this.isInvalid=!0,["Invalid boolean expression"])}}]),n}(n(190).AbstractParseTreeVisitor),Kt=function(){function e(t){Object(D.a)(this,e),this.text=t}return Object(F.a)(e,[{key:"toString",value:function(){return this.text}}]),e}(),Yt=(Ot=ve.g.bound,gt=function(){function e(t,n){var r,i,a,s=this;Object(D.a)(this,e),this.connection=t,this.name=void 0,Object(ye.a)(this,"conditionExpression",Et,this),Object(ye.a)(this,"priority",xt,this),this.errors=ve.r.map(),this.spec={conditionExpression:new We({default:""})},Object(ye.a)(this,"setPriority",jt,this),this.ConnectionView=Object(b.a)((function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(je,{key:"table"},o.a.createElement("tr",{key:"priority"},o.a.createElement("td",null,"Priority"),o.a.createElement("td",null,o.a.createElement(He,{keys:s.priorityChoices,value:""+s.priority,setValue:s.setPriority}))),o.a.createElement("tr",{key:"condition"},o.a.createElement("td",null,"Condition"),o.a.createElement("td",null,o.a.createElement(Qt,{m:s})))),o.a.createElement("div",null,o.a.createElement("h4",{style:{margin:"0"}},"Errors"),0===s.expressionErrors.length&&"No errors",o.a.createElement("ul",{style:{color:"indianred",marginTop:"0"},key:"errors"},s.expressionErrors.map((function(e,t){return o.a.createElement("li",{key:t},e)})))))})),this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"",this.conditionExpression=null!==(i=null===n||void 0===n?void 0:n.conditionExpression)&&void 0!==i?i:this.spec.conditionExpression.default,this.priority=null!==(a=null===n||void 0===n?void 0:n.priority)&&void 0!==a?a:t.from.outputs.length+1}return Object(F.a)(e,[{key:"condition",get:function(){return new $t(this.conditionExpression)}},{key:"priorityChoices",get:function(){return Object(y.a)(Array(this.connection.from.outputs.length)).map((function(e,t){return""+(t+1)}))}}]),Object(F.a)(e,[{key:"from",get:function(){return this.connection.from.data}},{key:"to",get:function(){return this.connection.to.data}},{key:"connectionText",get:function(){var e=this.conditionExpression.substring(0,20);return"".concat(this.priority,": ").concat(e).concat(this.conditionExpression.length>20?"...":"")}},{key:"toJson",get:function(){return{conditionExpression:this.conditionExpression,priority:this.priority}}},{key:"expressionErrors",get:function(){var e=this.connection.graph.globalData;try{var t=function(e,t){var n=nt.CharStreams.fromString(e),r=new ut(n),i=new nt.CommonTokenStream(r),a=new mt(i).parse(),o=new Wt(t),s=o.visit(a);void 0!==a.exception&&(o.isInvalid=!0,s.push("Invalid boolean expression"));var c=a.children;if(void 0!==c&&!o.isInvalid)for(var u=function(){var e=c.pop();if(e instanceof St&&void 0!==e.exception)return s.push("Invalid boolean expression"),"break";e.childCount>0&&(c=c.concat(Object(y.a)(Array(e.childCount).keys()).map((function(t){return e.getChild(t)}))))};0!==c.length;){if("break"===u())break}return{tree:a,errors:s}}(this.conditionExpression,{boolSignals:e.boolSignals.map((function(e){return e.name})),numSignals:e.numSignals.map((function(e){return e.name}))}),n=t.tree,r=t.errors;return console.log(n),r}catch(i){console.log("EEEEEEEEEEEEEEEE ".concat(i))}return[]}}]),e}(),Object(be.a)(gt.prototype,"condition",[ve.h],Object.getOwnPropertyDescriptor(gt.prototype,"condition"),gt.prototype),Et=Object(be.a)(gt.prototype,"conditionExpression",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=Object(be.a)(gt.prototype,"priority",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(be.a)(gt.prototype,"priorityChoices",[ve.h],Object.getOwnPropertyDescriptor(gt.prototype,"priorityChoices"),gt.prototype),jt=Object(be.a)(gt.prototype,"setPriority",[Ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var n=parseInt(t);if(e.priority!==n){var r=e.connection.from.outputs;e.priority>n?r.filter((function(t){return t.data.priority>=n&&t.data.priority<e.priority})).forEach((function(e){return e.data.priority++})):r.filter((function(t){return t.data.priority<=n&&t.data.priority>e.priority})).forEach((function(e){return e.data.priority--})),e.priority=n}}}}),Object(be.a)(gt.prototype,"connectionText",[ve.h],Object.getOwnPropertyDescriptor(gt.prototype,"connectionText"),gt.prototype),Object(be.a)(gt.prototype,"toJson",[ve.h],Object.getOwnPropertyDescriptor(gt.prototype,"toJson"),gt.prototype),Object(be.a)(gt.prototype,"expressionErrors",[ve.h],Object.getOwnPropertyDescriptor(gt.prototype,"expressionErrors"),gt.prototype),gt),Qt=Object(b.a)((function(e){var t=e.m,n=function(e){var t,n=[],r=-1,i=0,a="",o=function(){0!==a.length&&(n.push([new Kt(a),r-a.length]),a="")},s=function(e){o(),n.push([e,r])},c=Object(I.a)(e);try{for(c.s();!(t=c.n()).done;){var u=t.value;if(r++,0===i)switch(u){case" ":o();break;case")":case"(":case"<":case">":s(u);break;case"=":var l=n[n.length-1],p=l[0],h=p instanceof Kt?p.text:p;["<",">"].includes(h)&&l[1]===r-1?n[n.length-1][0]=p+"=":s(u);break;case"A":if("AND"===e.substring(r,r+3)){i=2,s("AND");continue}case"O":if("OR"===e.substring(r,r+2)){i=1,s("OR");continue}case"N":if("NOT"===e.substring(r,r+3)){i=2,s("NOT");continue}default:a+=u}else i--}}catch(d){c.e(d)}finally{c.f()}return 0!==a.length&&n.push([new Kt(a),r-a.length+1]),n}(t.conditionExpression),r=0,i=Object(a.useRef)(null),s={font:"400 15px monospace",width:"180px",height:"60px",overflow:"auto",borderRadius:"5px"};return o.a.createElement("div",{style:{width:"180px",position:"relative"},className:"center"},o.a.createElement("span",{style:Object(p.a)(Object(p.a)({},s),{},{position:"absolute",top:0,padding:"3px",textAlign:"initial",whiteSpace:"pre-line"}),ref:i},n.map((function(e,t){var n,i=Object(d.a)(e,2),a=i[0],s=i[1];n=a instanceof Kt?"black":["AND","NOT","OR"].includes(a)?"blue":"brown";var c=" ".repeat(s-r)+a.toString();return r=s+a.toString().length,o.a.createElement("span",{key:t,style:{color:n}},c)}))),o.a.createElement("textarea",{onScroll:function(e){i.current.scrollTo(0,e.currentTarget.scrollTop)},style:Object(p.a)(Object(p.a)({},s),{},{background:"transparent",color:"transparent",caretColor:"black",position:"relative",resize:"none"}),spellCheck:!1,value:t.conditionExpression,onSelect:function(e){},onChange:function(e){t.conditionExpression=e.currentTarget.value}}))})),$t=function e(t){Object(D.a)(this,e),this.expression=t};!function(e){e.bool="bool",e.sint="sint",e.int="int",e.lint="lint",e.dint="dint",e.usint="usint",e.uint="uint",e.ulint="ulint",e.udint="udint",e.real="real",e.lreal="lreal"}(Rt||(Rt={}));var Zt=(kt=function(){function e(t,n){var r=this;Object(D.a)(this,e),this.graph=t,this.workingFamilyTransitions=[],this.signals=void 0,this.generateCode=function(){return tt(r)},this.View=Object(b.a)((function(){return o.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},o.a.createElement("h2",{style:{margin:"0 0 10px 0"}},"Signals"),r.signals.map((function(e,t){return o.a.createElement("div",{className:"row",style:{display:"flex",alignItems:"center",padding:"3px 0"}},o.a.createElement(Ie.a,{type:"text",label:"name",value:e.name,onChange:function(t){return e.name=t.target.value},style:{width:"150px"}}),o.a.createElement("div",{style:{padding:"0 12px 0 12px"}},o.a.createElement(He,{keys:Object.keys(Rt),setValue:function(t){return e.type=t},value:e.type})),o.a.createElement(Ie.a,{type:"text",label:"default",value:e.defaultValue,onChange:function(t){return e.defaultValue=t.target.value},style:{width:"100px"}}),o.a.createElement("span",{style:{flex:1}}),o.a.createElement(Ne.a,{onClick:function(t){return r.signals.remove(e)}},o.a.createElement(Ae.a,{icon:"trash-alt",color:"#000"})))})),o.a.createElement(f.a,{style:{alignSelf:"flex-end"},onClick:function(e){return r.signals.push(new Xt({name:""}))}},"Add Signal"))}));var i=[];Array.isArray(null===n||void 0===n?void 0:n.signals)&&(i=null===n||void 0===n?void 0:n.signals.map((function(e){return"object"===typeof e?Xt.fromJson(e):void 0})).filter((function(e){return void 0!==e}))),this.signals=ve.r.array(i)}return Object(F.a)(e,[{key:"canAddNode",value:function(e){return e!==Ue.INITIAL||!this._hasInitialStep()}},{key:"_hasInitialStep",value:function(){return Object(y.a)(this.graph.nodes.values()).some((function(e){return e.data.type===Ue.INITIAL}))}},{key:"steps",get:function(){return Object(y.a)(this.graph.nodes.values()).map((function(e){return e.data}))}},{key:"numSignals",get:function(){return this.signals.filter((function(e){return e.type!==Rt.bool}))}},{key:"boolSignals",get:function(){return this.signals.filter((function(e){return e.type===Rt.bool}))}},{key:"initialStep",get:function(){return this.steps.find((function(e){return e.type===Ue.INITIAL}))}},{key:"toJson",get:function(){return{signals:this.signals.map((function(e){return e.toJson}))}}}]),e}(),Object(be.a)(kt.prototype,"steps",[ve.h],Object.getOwnPropertyDescriptor(kt.prototype,"steps"),kt.prototype),Object(be.a)(kt.prototype,"numSignals",[ve.h],Object.getOwnPropertyDescriptor(kt.prototype,"numSignals"),kt.prototype),Object(be.a)(kt.prototype,"boolSignals",[ve.h],Object.getOwnPropertyDescriptor(kt.prototype,"boolSignals"),kt.prototype),Object(be.a)(kt.prototype,"initialStep",[ve.h],Object.getOwnPropertyDescriptor(kt.prototype,"initialStep"),kt.prototype),Object(be.a)(kt.prototype,"toJson",[ve.h],Object.getOwnPropertyDescriptor(kt.prototype,"toJson"),kt.prototype),kt),Xt=(wt=function(){function e(t){var n,r,i;Object(D.a)(this,e),Object(ye.a)(this,"name",Nt,this),Object(ye.a)(this,"type",At,this),Object(ye.a)(this,"defaultValue",It,this),this.description=void 0,this.name=null!==(n=t.name)&&void 0!==n?n:"",this.description=t.description,this.type=null!==(r=t.type)&&void 0!==r?r:Rt.bool,this.defaultValue=null!==(i=t.defaultValue)&&void 0!==i?i:""}return Object(F.a)(e,[{key:"toJson",get:function(){return{name:this.name,type:this.type,defaultValue:this.defaultValue}}}],[{key:"fromJson",value:function(t){return"string"===typeof t.name&&Object.keys(Rt).includes(t.type)?new e(t):void 0}}]),e}(),Nt=Object(be.a)(wt.prototype,"name",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=Object(be.a)(wt.prototype,"type",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It=Object(be.a)(wt.prototype,"defaultValue",[ve.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(be.a)(wt.prototype,"toJson",[ve.h],Object.getOwnPropertyDescriptor(wt.prototype,"toJson"),wt.prototype),wt),qt={graphBuilder:function(e,t){return new Zt(e,t)},nodeBuilder:function(e,t){console.log(t);var n=void 0!==t?t.type:void 0;if("string"===typeof n&&Object.keys(Ue).includes(n))switch(n){case Ue.ENCLOSING:return new $e(e,t);case Ue.INITIAL:return new Qe(e,t);case Ue.MACRO:return new Ze(e,t);case Ue.SIMPLE:return new Ye(e,t)}return new Ye(e)},connectionBuilder:function(e,t){return new Yt(e,t)}},en=function(e){for(var t,n=new Ee({db:e,builders:qt}),r=(t={},Object(Ce.a)(t,Je.A,{A6:{type:Ue.INITIAL,x:60,y:60},A1:{type:Ue.SIMPLE,x:200,y:25},A2:{type:Ue.SIMPLE,x:180,y:300},A3:{type:Ue.SIMPLE,x:270,y:300},A4:{type:Ue.SIMPLE,x:360,y:200},A5:{type:Ue.MACRO,x:60,y:300},A7:{type:Ue.MACRO,x:160,y:200}}),Object(Ce.a)(t,Je.D,{D1:{type:Ue.MACRO,x:60,y:600},D2:{type:Ue.SIMPLE,x:90,y:500},D3:{type:Ue.ENCLOSING,x:200,y:500}}),Object(Ce.a)(t,Je.F,{F1:{type:Ue.MACRO,x:500,y:500},F2:{type:Ue.MACRO,x:500,y:200},F3:{type:Ue.MACRO,x:640,y:200},F4:{type:Ue.ENCLOSING,x:650,y:60},F5:{type:Ue.ENCLOSING,x:650,y:350},F6:{type:Ue.ENCLOSING,x:650,y:500}}),t),i={},a=0,o=Object.entries(r);a<o.length;a++)for(var s=Object(d.a)(o[a],2),c=s[0],u=s[1],l=0,p=Object.entries(u);l<p.length;l++){var h=Object(d.a)(p[l],2),f=h[0],y=h[1],b=n.addNode(y.type,{x:y.x,y:y.y});null===b||void 0===b||b.setName(f),b.data.family=c,i[f]=b}for(var v=0,m=Object.entries({A1:["F2","F1","F6","F5","F4"],A2:["A1"],A3:["A4"],A4:["F1"],A5:["A7"],A6:["A1"],A7:["A4"],F1:["F3","A2","A3","D1","D3"],F2:["F1"],F3:["A1"],F4:["A6"],D1:["D2","A5"],D2:["A5"],D3:["A2","A3"]});v<m.length;v++){var O,g=Object(d.a)(m[v],2),E=g[0],x=g[1],j=Object(I.a)(x);try{for(j.s();!(O=j.n()).done;){var k=O.value;n.addConnection(i[E],i[k])}}catch(A){j.e(A)}finally{j.f()}}var w=new Oe(i.A1,i.D1,(function(e){return new Yt(e,{name:"Emergency",conditionExpression:"I1 & I2"})}));n.globalData.workingFamilyTransitions.push(w.data);var N=i.A1;return n.selectNode(N),n.selectConnection(N.outputs[0]),n},tn=o.a.createContext(null);function nn(){var e=o.a.useContext(tn);if(!e)throw Error("useStore should be used inside a Store provider.");return e}function rn(){var e=o.a.useState(null),t=Object(d.a)(e,2),n=t[0],r=t[1],i=o.a.useState(null),a=Object(d.a)(i,2),s=a[0],c=a[1],u=s&&s.resetStore;return o.a.useEffect((function(){s?s.resetStore&&c(null):function(){return M.apply(this,arguments)}().then(function(){var e=Object(h.a)(l.a.mark((function e(t){var n,i,a,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(t),e.next=3,t.fetchGraphs();case 3:if(n=e.sent,void 0===(a=n[0])){e.next=12;break}return e.next=8,t.loadGraph(a.key);case 8:o=e.sent,i=new Ee({db:t,json:Object(p.a)({graph:a},o),builders:qt}),e.next=13;break;case 12:i=en(t);case 13:window.store=i,c(i);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[s,u]),s?o.a.createElement(tn.Provider,{value:s},o.a.createElement("div",{className:"row",style:{background:"rgba(250,250,250,0.7)",height:"100%"}},o.a.createElement("div",{className:"col",style:{width:"0px",background:"rgba(250,250,250,0.7)",flex:"1 0 auto"}},o.a.createElement("div",{className:"row",style:{minHeight:0,flex:1}},o.a.createElement("div",{className:"col"},o.a.createElement("div",{className:"row",style:{justifyContent:"flex-end"}},o.a.createElement(f.a,{onClick:function(e){s.saveModel()}},"Save"),o.a.createElement(f.a,{onClick:function(e){s.downloadModel()}},"Export"),o.a.createElement(f.a,null,o.a.createElement("label",{htmlFor:"import-file-input",style:{margin:0,width:"100%",cursor:"pointer"}},"Import"),o.a.createElement("input",{type:"file",id:"import-file-input",accept:"application/json",style:{display:"none"},onChange:function(){var e=Object(h.a)(l.a.mark((function e(t){var r,i,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(t);case 2:if("string"===typeof(r=e.sent))try{i=JSON.parse(r),a=new Ee({db:n,json:i,builders:qt}),c(a)}catch(t){console.log(t)}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}))),o.a.createElement(A,null)),o.a.createElement(_,null)),o.a.createElement(Re,null)))):o.a.createElement("div",{className:"center"},"Cargando...")}n(283),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.b.add(i.a,i.b,i.c),c.a.render(o.a.createElement(rn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[200,1,2]]]);
//# sourceMappingURL=main.a6dadc28.chunk.js.map